<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to AlpsNMR • AlpsNMR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to AlpsNMR">
<meta property="og:description" content="AlpsNMR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AlpsNMR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.99.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Vig01-introduction-to-alpsnmr.html">Introduction to AlpsNMR</a>
    </li>
    <li>
      <a href="../articles/Vig01b-introduction-to-alpsnmr-old-api.html">Introduction to AlpsNMR (older API)</a>
    </li>
    <li>
      <a href="../articles/Vig02-handling-metadata-and-annotations.html">Handling metadata and annotations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sipss/AlpsNMR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to AlpsNMR</h1>
                        <h4 data-toc-skip class="author">AlpsNMR
authors</h4>
            
            <h4 data-toc-skip class="date">2022-10-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sipss/AlpsNMR/blob/HEAD/vignettes/Vig01-introduction-to-alpsnmr.Rmd" class="external-link"><code>vignettes/Vig01-introduction-to-alpsnmr.Rmd</code></a></small>
      <div class="hidden name"><code>Vig01-introduction-to-alpsnmr.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>An introduction to the AlpsNMR package, showing the most
      relevant functions and a proposed workflow. This includes loading
      bruker NMR samples, adding sample annotations, preprocessing the
      spectra, detecting outliers, detecting peaks, aligning the samples
      and integrating the peaks to build a peak table.</p>
    </div>
    
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>The <code>AlpsNMR</code> package has most of its functions prefixed
with <code>nmr_</code>. The main reason for this is to avoid conflicts
with other packages. Besides, it helps for autocompletion: Most coding
environments such as RStudio will let you see most of the function names
by typing <code>nmr_</code> followed by pressing the tab key.</p>
<p>This vignette assumes some basic knowledge of NMR and data analysis,
and some basic R programming.</p>
<p>We will start by loading <code>AlpsNMR</code> along some convenience
packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sipss.github.io/AlpsNMR/" class="external-link">AlpsNMR</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: future</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'AlpsNMR'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="enable-parallellization">Enable parallellization<a class="anchor" aria-label="anchor" href="#enable-parallellization"></a>
</h2>
<p>This package is able to parallellize several functions through the
use of the <code>BiocParallel</code> package. Whether to parallelize or
not is left to the user that can control the parallellization
registering backends. Please check
<code><a href="https://bioconductor.org/packages/release/bioc/vignettes/BiocParallel/inst/doc/Introduction_To_BiocParallel.pdf" class="external-link">vignette("Introduction_To_BiocParallel", package = "BiocParallel")</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#register(SerialParam(), default = TRUE)  # disable parallellization</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SnowParam-class.html" class="external-link">SnowParam</a></span><span class="op">(</span>workers <span class="op">=</span> <span class="fl">3</span>, exportglobals <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, default <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># enable parallellization with 3 workers</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-the-meoh_plasma_extraction-dataset">Data: The <code>MeOH_plasma_extraction</code> dataset<a class="anchor" aria-label="anchor" href="#data-the-meoh_plasma_extraction-dataset"></a>
</h2>
<p>To explore the basics of the AlpsNMR package, we have included three
NMR samples acquired in a 600 MHz Bruker instrument bundled with the
package. The samples are pooled quality control plasma samples, that
were extracted with methanol. They only contain small molecules.</p>
<p>If you have installed this package, you can obtain the directory
where the samples are with the command:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MeOH_plasma_extraction_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"dataset-demo"</span>, package <span class="op">=</span> <span class="st">"AlpsNMR"</span><span class="op">)</span></span>
<span><span class="va">MeOH_plasma_extraction_dir</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/__w/_temp/Library/AlpsNMR/dataset-demo"</span></span></code></pre>
<p>The demo directory includes three zipped Bruker samples and a dummy
Excel metadata file:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">MeOH_plasma_extraction_dir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "10.zip"              "20.zip"              "30.zip"             </span></span>
<span><span class="co">## [4] "dummy_metadata.xlsx" "README.txt"</span></span></code></pre>
<p>Since these are quality control samples, the metadata is a dummy
table:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MeOH_plasma_extraction_xlsx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">MeOH_plasma_extraction_dir</span>, <span class="st">"dummy_metadata.xlsx"</span><span class="op">)</span></span>
<span><span class="va">annotations</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">MeOH_plasma_extraction_xlsx</span><span class="op">)</span></span>
<span><span class="va">annotations</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">##   NMRExperiment SubjectID TimePoint</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 10            Ana       baseline </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 20            Ana       3 months </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 30            Elia      baseline</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="loading-samples">Loading samples<a class="anchor" aria-label="anchor" href="#loading-samples"></a>
</h2>
<p>The function to read samples is called
<code><a href="../reference/nmr_read_samples.html">nmr_read_samples()</a></code>. It expects a character vector with the
samples to load that can be paths to directories of Bruker format
samples or paths to JDX files.</p>
<p>Additionally, this function can filter by pulse sequences (e.g. load
only NOESY samples) or loading only metadata.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zip_files</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html" class="external-link">dir_ls</a></span><span class="op">(</span><span class="va">MeOH_plasma_extraction_dir</span>, glob <span class="op">=</span> <span class="st">"*.zip"</span><span class="op">)</span></span>
<span><span class="va">zip_files</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BB0000; font-weight: bold;">/__w/_temp/Library/AlpsNMR/dataset-demo/10.zip</span></span></span>
<span><span class="co">## <span style="color: #BB0000; font-weight: bold;">/__w/_temp/Library/AlpsNMR/dataset-demo/20.zip</span></span></span>
<span><span class="co">## <span style="color: #BB0000; font-weight: bold;">/__w/_temp/Library/AlpsNMR/dataset-demo/30.zip</span></span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_read_samples.html">nmr_read_samples</a></span><span class="op">(</span>sample_names <span class="op">=</span> <span class="va">zip_files</span><span class="op">)</span></span>
<span><span class="va">dataset</span></span></code></pre></div>
<pre><code><span><span class="co">## An nmr_dataset (3 samples)</span></span></code></pre>
<p>If your samples happen to be in different <strong>folders per
class</strong>, AlpsNMR provides convenience functions to read them as
well. With this example:</p>
<pre><code>- your_dataset/
  + control/
     * 10/
     * 20/
     * 30/
  + mutated/
     * 10/
     * 20/
     * 30/</code></pre>
<p>You could use:</p>
<pre><code><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_read_samples.html">nmr_read_samples_dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"your_dataset/control"</span>, <span class="st">"your_dataset/mutated"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dataset</span></span></code></pre>
<p>If after reading the <code><a href="../reference/nmr_read_samples.html">?nmr_read_samples</a></code> page you still
have issues, feel free to open an issue at <a href="https://github.com/sipss/AlpsNMR/issues" class="external-link uri">https://github.com/sipss/AlpsNMR/issues</a> and ask for
clarification.</p>
</div>
<div class="section level2">
<h2 id="adding-annotations">Adding annotations<a class="anchor" aria-label="anchor" href="#adding-annotations"></a>
</h2>
<p>We can embed the external annotations we loaded above into the
dataset:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_meta_add.html">nmr_meta_add</a></span><span class="op">(</span><span class="va">dataset</span>, metadata <span class="op">=</span> <span class="va">annotations</span>, by <span class="op">=</span> <span class="st">"NMRExperiment"</span><span class="op">)</span></span></code></pre></div>
<p>And retrieve them from the dataset:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nmr_meta_get.html">nmr_meta_get</a></span><span class="op">(</span><span class="va">dataset</span>, groups <span class="op">=</span> <span class="st">"external"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">##   NMRExperiment SubjectID TimePoint</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 10            Ana       baseline </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 20            Ana       3 months </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 30            Elia      baseline</span></span></code></pre>
<p>If you want to learn more about sample metadata (including
acquisition and FID processing parameters), as well as more complex ways
of adding annotations, check out the
<code><a href="../articles/Vig02-handling-metadata-and-annotations.html">vignette("Vig02-handling-metadata-and-annotations", package = "AlpsNMR")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="interpolation">Interpolation<a class="anchor" aria-label="anchor" href="#interpolation"></a>
</h2>
<p>1D NMR samples can be interpolated together, in order to arrange all
the spectra into a matrix, with one row per sample. Here we choose the
range of ppm values that we want to include in further analyses.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_interpolate_1D.html">nmr_interpolate_1D</a></span><span class="op">(</span><span class="va">dataset</span>, axis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>min <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If the <code>axis = NULL</code> then the ppm axis is autodetected
from the samples.</p>
<p>See <code><a href="../reference/nmr_interpolate_1D.html">nmr_interpolate_1D()</a></code> for further reference on the
axis options.</p>
</div>
<div class="section level2">
<h2 id="plotting-samples">Plotting samples<a class="anchor" aria-label="anchor" href="#plotting-samples"></a>
</h2>
<p>Plotting many spectra with so many points is quite expensive so it is
possible to include only some regions of the spectra or plot only some
samples.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, NMRExperiment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10"</span>, <span class="st">"30"</span><span class="op">)</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.2</span>, <span class="fl">2.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<!--
See `vignette("Vig03-plotting-samples", package="AlpsNMR")` for more advanced plot options, or
having interactive plots.
-->
</div>
<div class="section level2">
<h2 id="exclude-regions">Exclude regions<a class="anchor" aria-label="anchor" href="#exclude-regions"></a>
</h2>
<p>Some regions can easily be excluded from the spectra with
<code><a href="../reference/nmr_exclude_region.html">nmr_exclude_region()</a></code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regions_to_exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>water <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.6</span>, <span class="fl">5</span><span class="op">)</span>, methanol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.33</span>, <span class="fl">3.39</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_exclude_region.html">nmr_exclude_region</a></span><span class="op">(</span><span class="va">dataset</span>, exclude <span class="op">=</span> <span class="va">regions_to_exclude</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.2</span>, <span class="fl">5.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="filter-samples">Filter samples<a class="anchor" aria-label="anchor" href="#filter-samples"></a>
</h2>
<p>Maybe we just want to analyze a subset of the data, e.g., only a
class group or a particular gender. We can filter some samples according
to their metadata as follows:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samples_10_20</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">SubjectID</span> <span class="op">==</span> <span class="st">"Ana"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nmr_meta_get.html">nmr_meta_get</a></span><span class="op">(</span><span class="va">samples_10_20</span>, groups <span class="op">=</span> <span class="st">"external"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">##   NMRExperiment SubjectID TimePoint</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 10            Ana       baseline </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 20            Ana       3 months</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="robust-pca-for-outlier-detection">Robust PCA for outlier detection<a class="anchor" aria-label="anchor" href="#robust-pca-for-outlier-detection"></a>
</h2>
<p>The AlpsNMR package includes robust PCA analysis for outlier
detection.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_outliers_rob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_pca_outliers_robust.html">nmr_pca_outliers_robust</a></span><span class="op">(</span><span class="va">dataset</span>, ncomp <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nmr_pca_outliers_plot.html">nmr_pca_outliers_plot</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">pca_outliers_rob</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>Samples with greater QResiduals and Tscores than the threshold
defined by the red line are candidates for further exploration and
exclusion. With this small dataset, there is not much to see.</p>
</div>
<div class="section level2">
<h2 id="baseline-estimation">Baseline estimation<a class="anchor" aria-label="anchor" href="#baseline-estimation"></a>
</h2>
<p>Spectra may display an unstable baseline, specially when processing
blood/fecal samples.</p>
<p>The peak detection and integration algorithms benefit from having an
estimation of the baseline, so it is advisable to compute it first and
check it fits as expected.</p>
<p>See before:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.37</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>,<span class="fl">3.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Estimate the baseline:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_baseline_estimation.html">nmr_baseline_estimation</a></span><span class="op">(</span><span class="va">dataset</span>, lambda <span class="op">=</span> <span class="fl">9</span>, p <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
<p>And after:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># TODO: Simplify this plot</span></span>
<span><span class="va">spectra_to_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.37</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">baseline_to_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.37</span>, <span class="fl">2.5</span><span class="op">)</span>, matrix_name <span class="op">=</span> <span class="st">"data_1r_baseline"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">chemshift</span>, y <span class="op">=</span> <span class="va">intensity</span>, color <span class="op">=</span> <span class="va">NMRExperiment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">spectra_to_plot</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">baseline_to_plot</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">NMRExperiment</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-16-1.png" width="960"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># TODO: Simplify this plot</span></span>
<span><span class="va">spectra_to_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">3.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">baseline_to_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">3.8</span><span class="op">)</span>, matrix_name <span class="op">=</span> <span class="st">"data_1r_baseline"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">chemshift</span>, y <span class="op">=</span> <span class="va">intensity</span>, color <span class="op">=</span> <span class="va">NMRExperiment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">spectra_to_plot</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">baseline_to_plot</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">NMRExperiment</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-17-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="peak-detection">Peak detection<a class="anchor" aria-label="anchor" href="#peak-detection"></a>
</h2>
<p>The peak detection is performed on short spectra segments using a
continuous wavelet transform. Peaks below a threshold intensity are
automatically discarded.</p>
<p>Our current approach relies on the use of the baseline threshold
(<code>baselineThresh</code>) automatically calculated (see
<code><a href="../reference/nmr_baseline_threshold.html">?nmr_baseline_threshold</a></code>) and the Signal to Noise Threshold
(<code>SNR.Th</code>) to discriminate valid peaks from noise.</p>
<p>See <code><a href="../reference/nmr_detect_peaks.html">?nmr_detect_peaks</a></code> for more information.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baselineThresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_baseline_threshold.html">nmr_baseline_threshold</a></span><span class="op">(</span><span class="va">dataset</span>, range_without_peaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9.5</span>, <span class="fl">10</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"median3mad"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nmr_baseline_threshold_plot.html">nmr_baseline_threshold_plot</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">baselineThresh</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak_list_initial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_detect_peaks.html">nmr_detect_peaks</a></span><span class="op">(</span></span>
<span>    <span class="va">dataset</span>,</span>
<span>    nDivRange_ppm <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    baselineThresh <span class="op">=</span> <span class="va">baselineThresh</span>,</span>
<span>    SNR.Th <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    fit_lorentzians <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can get an overview of the number of peaks we detect on each
sample and each chemical shift region:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nmr_detect_peaks_plot_overview.html">nmr_detect_peaks_plot_overview</a></span><span class="op">(</span><span class="va">peak_list_initial</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>We can explore in a more detailed way the detected peaks:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nmr_detect_peaks_plot.html">nmr_detect_peaks_plot</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">peak_list_initial</span>, NMRExperiment <span class="op">=</span> <span class="st">"10"</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>Let’s the detected peaks in a smaller region across samples:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak_list_in_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">peak_list_initial</span>, <span class="va">ppm</span> <span class="op">&gt;</span> <span class="fl">3.22</span>, <span class="va">ppm</span> <span class="op">&lt;</span> <span class="fl">3.24</span><span class="op">)</span></span>
<span><span class="va">peak_list_in_range</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 11</span></span></span>
<span><span class="co">##   peak_id  NMRExperi…¹   ppm   pos inten…² inten…³ ppm_i…⁴ ppm_i…⁵ gamma…⁶  area</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Peak0211 10           3.23 <span style="text-decoration: underline;">16</span>281 <span style="text-decoration: underline;">239</span>459. <span style="text-decoration: underline;">224</span>420.    3.23    3.23    1.80 <span style="text-decoration: underline;">1</span>272.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Peak0212 10           3.24 <span style="text-decoration: underline;">16</span>308 <span style="text-decoration: underline;">358</span>753. <span style="text-decoration: underline;">343</span>534.    3.24    3.24    1.23 <span style="text-decoration: underline;">1</span>358.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Peak0603 20           3.23 <span style="text-decoration: underline;">16</span>283 <span style="text-decoration: underline;">291</span>094. <span style="text-decoration: underline;">267</span>693.    3.23    3.23    2.71 <span style="text-decoration: underline;">2</span>241.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Peak0604 20           3.24 <span style="text-decoration: underline;">16</span>309 <span style="text-decoration: underline;">399</span>656. <span style="text-decoration: underline;">375</span>897.    3.24    3.24    1.80 <span style="text-decoration: underline;">1</span>986.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Peak1002 30           3.23 <span style="text-decoration: underline;">16</span>281 <span style="text-decoration: underline;">243</span>670. <span style="text-decoration: underline;">232</span>273.    3.23    3.23    2.32 <span style="text-decoration: underline;">1</span>704.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Peak1003 30           3.24 <span style="text-decoration: underline;">16</span>308 <span style="text-decoration: underline;">464</span>835. <span style="text-decoration: underline;">453</span>429.    3.24    3.24    1.79 <span style="text-decoration: underline;">2</span>543.</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 1 more variable: norm_rmse &lt;dbl&gt;, and abbreviated variable names</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ¹​NMRExperiment, ²​intensity_raw, ³​intensity, ⁴​ppm_infl_min, ⁵​ppm_infl_max,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁶​gamma_ppb</span></span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.22</span>, <span class="fl">3.25</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nmr_detect_peaks_plot_peaks.html">nmr_detect_peaks_plot_peaks</a></span><span class="op">(</span></span>
<span>    <span class="va">dataset</span>,</span>
<span>    <span class="va">peak_list_initial</span>,</span>
<span>    peak_ids <span class="op">=</span> <span class="va">peak_list_in_range</span><span class="op">$</span><span class="va">peak_id</span>,</span>
<span>    caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"{peak_id}"</span>,</span>
<span>                    <span class="st">"(NMRExp.\u00A0{NMRExperiment},"</span>,</span>
<span>                    <span class="st">"gamma(ppb)\u00a0=\u00a0{gamma_ppb},"</span>,</span>
<span>                    <span class="st">"\narea\u00a0=\u00a0{area},"</span>,</span>
<span>                    <span class="st">"nrmse\u00a0=\u00a0{norm_rmse})"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak_list_initial_accepted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peaklist_accept_peaks.html">peaklist_accept_peaks</a></span><span class="op">(</span></span>
<span>    <span class="va">peak_list_initial</span>,</span>
<span>    <span class="va">dataset</span>,</span>
<span>    area_min <span class="op">=</span> <span class="fl">50</span>, </span>
<span>    keep_rejected <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Acceptance report</span></span>
<span><span class="co">## <span style="color: #0000BB;">ℹ</span> 833/1127 peaks accepted. (73.9%)</span></span>
<span><span class="co">## <span style="color: #0000BB;">ℹ</span> Removing 294 peaks</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="spectra-alignment">Spectra alignment<a class="anchor" aria-label="anchor" href="#spectra-alignment"></a>
</h2>
<p>Once we have a preliminary peak list, we can align the spectra using
the <code><a href="../reference/nmr_align.html">nmr_align()</a></code> function. We expect shifts between the
spectra, this becomes necessary so we can cluster the peaks correctly
afterwards and build a peak table.</p>
<p>The alignment process takes several parameters, including:</p>
<ul>
<li><p><code>NMRExp_ref</code>: An NMRExperiment with a reference
sample. Usually it should be a pool of all samples if it is available.
Otherwise, you can use <code><a href="../reference/nmr_align_find_ref.html">nmr_align_find_ref()</a></code> to find a
sample. Depending on how heterogeneous your dataset is, there may not be
a good reference sample (even if the function picks one, the alignment
might not succeed), so please always check the results
afterwards.</p></li>
<li><p><code>maxShift_ppm</code>: The maximum shift allowed when
aligning the spectra.</p></li>
<li><p><code>acceptLostPeak</code>: Set it to <code>TRUE</code> if you
want to accept some peaks getting lost during the alignment process.
Since the peak detection is never perfect, it is reasonable to accept
some lost peaks.</p></li>
</ul>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NMRExp_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_align_find_ref.html">nmr_align_find_ref</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">peak_list_initial_accepted</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Your reference is NMRExperiment "</span>, <span class="va">NMRExp_ref</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Your reference is NMRExperiment 20</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset_align</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_align.html">nmr_align</a></span><span class="op">(</span></span>
<span>    nmr_dataset <span class="op">=</span> <span class="va">dataset</span>, </span>
<span>    peak_data <span class="op">=</span> <span class="va">peak_list_initial_accepted</span>, </span>
<span>    NMRExp_ref <span class="op">=</span> <span class="va">NMRExp_ref</span>, </span>
<span>    maxShift_ppm <span class="op">=</span> <span class="fl">0.0015</span>, </span>
<span>    acceptLostPeak <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Compare the dataset before and after alignment, to verify the quality
of the alignment:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.025</span>, <span class="fl">3.063</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset_align</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.025</span>, <span class="fl">3.063</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-28-2.png" width="700"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.22</span>, <span class="fl">3.25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset_align</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.22</span>, <span class="fl">3.25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="normalization">Normalization<a class="anchor" aria-label="anchor" href="#normalization"></a>
</h2>
<p>With the spectra correctly aligned, you can use spectra normalization
techniques. We normalize after alignment because some of the
normalization techniques are sensitive to misalignments.</p>
<p>There are multiple normalization techniques available. The most
strongly recommended is the Probabilistic Quantile Normalization
(<code>pqn</code>), but it requires more samples for its internal
estimations to be reliable, as it needs a computation of the median
spectra. Nevertheless, it is possible to compute it:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_normalize.html">nmr_normalize</a></span><span class="op">(</span><span class="va">dataset_align</span>, method <span class="op">=</span> <span class="st">"pqn"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: There are not enough samples for reliably estimating the median spectra</span></span>
<span><span class="co">## <span style="color: #0000BB;">ℹ</span> The Probabalistic Quotient Normalization requires several samples to compute the median spectra. Your number of samples is low</span></span>
<span><span class="co">## <span style="color: #0000BB;">ℹ</span> Review your peaks before and after normalization to ensure there are no big distortions</span></span></code></pre>
<p>The normalization essentially computes a normalization factor for
each sample.</p>
<p>The plot shows the dispersion with respect to the median of the
normalization factors, and can highlight samples with abnormally large
or small normalization factors.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normalization_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_normalize.html">nmr_normalize_extra_info</a></span><span class="op">(</span><span class="va">dataset_norm</span><span class="op">)</span></span>
<span><span class="va">normalization_info</span><span class="op">$</span><span class="va">norm_factor</span></span></code></pre></div>
<pre><code><span><span class="co">##   NMRExperiment norm_factor norm_factor_norm</span></span>
<span><span class="co">## 1            10   0.8478185        0.8478185</span></span>
<span><span class="co">## 2            20   1.1417458        1.1417458</span></span>
<span><span class="co">## 3            30   1.0000000        1.0000000</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normalization_info</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>We can confirm sample 20 is now slightly more diluted:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">to_plot</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">dataset_align</span>, NMRExperiment <span class="op">=</span> <span class="st">"20"</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Normalized <span class="op">=</span> <span class="st">"No"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">dataset_norm</span>, NMRExperiment <span class="op">=</span> <span class="st">"20"</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Normalized <span class="op">=</span> <span class="st">"Yes"</span><span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">to_plot</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">chemshift</span>, y <span class="op">=</span> <span class="va">intensity</span>, color <span class="op">=</span> <span class="va">Normalized</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Intensity"</span>, x <span class="op">=</span> <span class="st">"Chemical shift (ppm)"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"The normalization slightly diluted experiment 20"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<p>And all samples are more homogeneous now:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset_align</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Before Normalization"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset_norm</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"After Normalization"</span><span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="peak-grouping">Peak grouping<a class="anchor" aria-label="anchor" href="#peak-grouping"></a>
</h2>
<p>If you align or normalize your samples, you should rerun the peak
detection to ensure the peak positions and estimations are well
calculated:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baselineThresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_baseline_threshold.html">nmr_baseline_threshold</a></span><span class="op">(</span><span class="va">dataset_norm</span>, range_without_peaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9.5</span>, <span class="fl">10</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"median3mad"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nmr_baseline_threshold_plot.html">nmr_baseline_threshold_plot</a></span><span class="op">(</span><span class="va">dataset_norm</span>, <span class="va">baselineThresh</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak_list_for_clustering_unfiltered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_detect_peaks.html">nmr_detect_peaks</a></span><span class="op">(</span></span>
<span>    <span class="va">dataset_norm</span>,</span>
<span>    nDivRange_ppm <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    baselineThresh <span class="op">=</span> <span class="va">baselineThresh</span>,</span>
<span>    SNR.Th <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    fit_lorentzians <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">peak_list_for_clustering</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peaklist_accept_peaks.html">peaklist_accept_peaks</a></span><span class="op">(</span></span>
<span>    <span class="va">peak_list_for_clustering_unfiltered</span>,</span>
<span>    <span class="va">dataset_norm</span>,</span>
<span>    area_min <span class="op">=</span> <span class="fl">50</span>, </span>
<span>    keep_rejected <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Acceptance report</span></span>
<span><span class="co">## <span style="color: #0000BB;">ℹ</span> 837/1128 peaks accepted. (74.2%)</span></span>
<span><span class="co">## <span style="color: #0000BB;">ℹ</span> Removing 291 peaks</span></span></code></pre>
<p>Feel free to plot, explore and further curate your peak list. Or
proceed with the current one:</p>
<p>Once we have a peak list for each sample <code>peak_list</code>, we
need to turn it into a table, merging peaks from different samples
together.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clustering</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_peak_clustering.html">nmr_peak_clustering</a></span><span class="op">(</span><span class="va">peak_list_for_clustering</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #0000BB;">ℹ</span> The maximum distance between two peaks in the same cluster is of 7.6</span></span>
<span><span class="co">## ppbs</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>    <span class="va">clustering</span><span class="op">$</span><span class="va">num_cluster_estimation</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Full"</span><span class="op">)</span>,</span>
<span>    <span class="va">clustering</span><span class="op">$</span><span class="va">num_cluster_estimation</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="va">clustering</span><span class="op">$</span><span class="va">num_cluster_estimation</span><span class="op">$</span><span class="va">num_clusters</span><span class="op">-</span><span class="fl">50</span>, <span class="va">clustering</span><span class="op">$</span><span class="va">num_cluster_estimation</span><span class="op">$</span><span class="va">num_clusters</span><span class="op">+</span><span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">*</span><span class="va">clustering</span><span class="op">$</span><span class="va">num_cluster_estimation</span><span class="op">$</span><span class="va">max_dist_thresh_ppb</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fine region"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak_list_clustered</span> <span class="op">&lt;-</span> <span class="va">clustering</span><span class="op">$</span><span class="va">peak_data</span></span></code></pre></div>
<p>We can plot the samples, with the detected peaks and how they have
been connected. This allows us to compare the peak detection across
samples, and check how good the peak matching is.</p>
<p>If peaks are matched they are connected with a black segment. If
peaks are detected but not matched, they appear as a dot. If you see a
peak, without a point on top then it means the peak was not detected or
it was filtered out.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nmr_peak_clustering_plot.html">nmr_peak_clustering_plot</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">dataset_norm</span>,</span>
<span>    peak_list_clustered <span class="op">=</span> <span class="va">peak_list_clustered</span>,</span>
<span>    NMRExperiments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10"</span>, <span class="st">"20"</span><span class="op">)</span>,</span>
<span>    chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.4</span>, <span class="fl">3.0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
<p>Sometimes we see peaks and we wonder why are they not detected. We
can include the <code>baselineThresh</code> to plot it in the sample as
well. This can help to diagnose if the <code>baselineThresh</code>
argument is the cause of a peak not being detected.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nmr_peak_clustering_plot.html">nmr_peak_clustering_plot</a></span><span class="op">(</span></span>
<span>    <span class="va">dataset_norm</span>,</span>
<span>    <span class="va">peak_list_clustered</span>, </span>
<span>    NMRExperiments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10"</span>, <span class="st">"20"</span><span class="op">)</span>,</span>
<span>    chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.2</span>, <span class="fl">4.6</span><span class="op">)</span>,</span>
<span>    baselineThresh <span class="op">=</span> <span class="va">baselineThresh</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Vig01-introduction-to-alpsnmr_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_build_peak_table.html">nmr_build_peak_table</a></span><span class="op">(</span><span class="va">peak_list_clustered</span>, <span class="va">dataset_norm</span><span class="op">)</span></span>
<span><span class="va">peak_table</span></span></code></pre></div>
<pre><code><span><span class="co">## An nmr_dataset_peak_table (3 samples, and 327 peaks)</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_data.html">nmr_data</a></span><span class="op">(</span><span class="va">peak_table</span><span class="op">)</span></span>
<span><span class="va">peak_matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##      0.8119   0.8223   0.8247    0.8333    0.8447   0.8479    0.8553   0.8605</span></span>
<span><span class="co">## 10 248.1267       NA       NA  576.0143  583.9753 584.6623  234.5596 316.6228</span></span>
<span><span class="co">## 20 411.9895 1448.242 651.2340 1062.1772 1039.3439       NA 1628.4974 426.1569</span></span>
<span><span class="co">## 30 286.1166       NA 963.8636  886.4543  859.2278       NA 1761.5359 574.4400</span></span></code></pre>
<p>Or you can get a data frame with the corresponding annotations:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak_table_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">peak_table</span><span class="op">)</span></span>
<span><span class="va">peak_table_df</span></span></code></pre></div>
<pre><code><span><span class="co">##    NMRExperiment SubjectID TimePoint   0.8119   0.8223   0.8247    0.8333</span></span>
<span><span class="co">## 10            10       Ana  baseline 248.1267       NA       NA  576.0143</span></span>
<span><span class="co">## 20            20       Ana  3 months 411.9895 1448.242 651.2340 1062.1772</span></span>
<span><span class="co">## 30            30      Elia  baseline 286.1166       NA 963.8636  886.4543</span></span>
<span><span class="co">##       0.8447   0.8479    0.8553   0.8605   0.8656   0.8729   0.8784   0.8910</span></span>
<span><span class="co">## 10  583.9753 584.6623  234.5596 316.6228 789.1244 293.0063 464.0081 294.2186</span></span>
<span><span class="co">## 20 1039.3439       NA 1628.4974 426.1569 754.8023 485.4725 704.8556 622.1860</span></span>
<span><span class="co">## 30  859.2278       NA 1761.5359 574.4400 881.7160 544.6913 513.5834 463.6449</span></span>
<span><span class="co">##      0.9034   0.9087   0.9158   0.9197   0.9314   0.9437   0.9554    0.9658</span></span>
<span><span class="co">## 10 350.8436 341.2886 319.6393 299.8821 299.5249 363.8845 703.9568  937.0603</span></span>
<span><span class="co">## 20 719.4185 585.6042       NA 464.9987 456.8718 534.5573 869.8690 1325.2469</span></span>
<span><span class="co">## 30 562.9421 539.3869 597.7612 484.1953 447.1456 510.5058 808.2868 1111.3046</span></span>
<span><span class="co">##      0.9758    0.9903   1.0020   1.0091   1.0208   1.0409   1.0526    1.0595</span></span>
<span><span class="co">## 10 602.7438  752.4888 760.9498 264.6978 228.0143 686.4252 683.5871  84.61342</span></span>
<span><span class="co">## 20 843.1016 1010.4783 999.9029 330.4955 295.2787 925.4050 917.6458        NA</span></span>
<span><span class="co">## 30 679.3239  940.9196 927.1883 330.1383 273.9946 830.3180 831.3827 126.11231</span></span>
<span><span class="co">##       1.0717   1.1749   1.1870   1.1980   1.2085   1.2179   1.2294   1.2366</span></span>
<span><span class="co">## 10  57.54959       NA 566.4997 655.1246  913.711 1421.560 1582.320 2743.867</span></span>
<span><span class="co">## 20 184.61314 461.9955       NA 929.4432 1477.699 2144.071 3180.656       NA</span></span>
<span><span class="co">## 30  82.12987 332.8322 713.8190 915.8183 1364.905 2251.681 2848.690 6061.104</span></span>
<span><span class="co">##      1.2408   1.2539   1.2713  1.2807   1.3261   1.3378   1.4309   1.4423</span></span>
<span><span class="co">## 10 6760.678 1599.496 459.1636      NA 15599.64 15747.66 108.5837 128.8285</span></span>
<span><span class="co">## 20 2881.720 1800.636 766.8677 385.077 19291.51 19632.59 125.4677 173.6485</span></span>
<span><span class="co">## 30 3998.339       NA 712.6687      NA 19158.06 19139.56 126.1861 159.7446</span></span>
<span><span class="co">##      1.4792   1.4914   1.5184   1.5228    1.5363    1.5476   1.5587   1.5817</span></span>
<span><span class="co">## 10 1269.666 1290.973 196.9007 212.0830  91.68993  59.68394 62.65614 77.91319</span></span>
<span><span class="co">## 20 1656.032 1641.459 222.9828 272.9507 125.92358  62.59575       NA       NA</span></span>
<span><span class="co">## 30 1532.112 1559.736       NA 185.4979 130.89308 142.13841 54.32582       NA</span></span>
<span><span class="co">##      1.6195   1.6319   1.6443   1.6562   1.6677    1.6752    1.6798   1.6885</span></span>
<span><span class="co">## 10 106.6812       NA 56.70433 58.18571 125.9569  70.13182  81.70442 186.5147</span></span>
<span><span class="co">## 20 130.9582 57.82216 51.23069 62.75361 114.7789 154.95271 118.86451 242.2358</span></span>
<span><span class="co">## 30 135.2878       NA 73.51829 82.18994 102.0515 121.55784  87.82801 248.1314</span></span>
<span><span class="co">##      1.6929   1.6991   1.7071   1.7099   1.7202    1.7234   1.7349   1.7472</span></span>
<span><span class="co">## 10 121.0123 129.5784 226.5209 294.9620 580.2443 1321.8939 653.9539 377.4230</span></span>
<span><span class="co">## 20       NA 185.0226 532.7183       NA       NA  828.4129 732.7386 372.6475</span></span>
<span><span class="co">## 30 240.6351 172.8209       NA 503.2867       NA  864.8788 667.1568 447.9792</span></span>
<span><span class="co">##      1.7525   1.7612   1.7649  1.7782   1.8997   1.9212   1.9315   1.9441</span></span>
<span><span class="co">## 10 251.0483 135.7918       NA 62.8358 61.65235 1203.263 315.9742 187.0653</span></span>
<span><span class="co">## 20 321.2381 224.2714       NA      NA 78.37188 1330.834 218.9574 331.3298</span></span>
<span><span class="co">## 30 265.8839 166.4631 113.3322      NA 75.48974 1514.066 277.9065 227.3126</span></span>
<span><span class="co">##      1.9545   1.9620   1.9721   1.9813   1.9909   2.0031   2.0079   2.0143</span></span>
<span><span class="co">## 10 208.9239 176.1407 182.9421 234.5886 224.1195 224.3858 226.4651 208.5120</span></span>
<span><span class="co">## 20 299.4997 167.0353 356.3810 353.0795 275.8973 303.7907 237.1840 274.1992</span></span>
<span><span class="co">## 30 262.9043 233.6621 230.1438 339.1926 248.8792 273.7876 249.2916 225.4372</span></span>
<span><span class="co">##      2.0198   2.0308   2.0423   2.0528    2.0670   2.0711   2.0810   2.0925</span></span>
<span><span class="co">## 10 227.3430 321.7809 1302.207 1314.588  752.9152       NA 496.2828 307.7216</span></span>
<span><span class="co">## 20 294.0752 419.6869 1508.661 1365.811 1074.0889       NA 695.0036 309.9704</span></span>
<span><span class="co">## 30 271.9755 379.8256 1480.583 1221.542  739.5373 747.6152 613.0113 332.4115</span></span>
<span><span class="co">##       2.1069    2.1152   2.1195   2.1275   2.1324   2.1413   2.1445   2.1493</span></span>
<span><span class="co">## 10  93.78926  76.84987 224.5092 246.5000 319.5973 359.7242 278.7487 207.9622</span></span>
<span><span class="co">## 20 147.64946 164.23752 265.0589 298.1992 334.9369 620.8959       NA 451.2702</span></span>
<span><span class="co">## 30 114.24105 102.06038 245.9558 240.4358 341.7655 437.8781 406.5889       NA</span></span>
<span><span class="co">##      2.1528   2.1573   2.1656   2.2644    2.2717    2.2761    2.2834  2.2878</span></span>
<span><span class="co">## 10 201.1596 172.3602 103.8398 60.50905  85.23804  90.78695  96.06215      NA</span></span>
<span><span class="co">## 20 256.5145 222.5517 139.4829 75.59151 115.05230 124.85984 149.18579  119.76</span></span>
<span><span class="co">## 30 280.3576 269.9405 128.6531 75.99915 108.31402 116.67781 132.27963  291.02</span></span>
<span><span class="co">##      2.2951   2.3013   2.3141   2.3251   2.3398   2.3451   2.3513   2.3575</span></span>
<span><span class="co">## 10 106.1659 127.1724 123.6337 144.0820 335.3851 276.8338 877.0104 706.6683</span></span>
<span><span class="co">## 20 165.0580 276.9065 194.2737 190.2546 550.3349 375.2403 813.4507 708.7526</span></span>
<span><span class="co">## 30 150.2212 213.4635 167.1973 171.7209 410.4368 354.3636 745.0315 606.8055</span></span>
<span><span class="co">##      2.3646   2.3712   2.3852   2.3935   2.4063   2.4196   2.4304   2.4400</span></span>
<span><span class="co">## 10 237.0716 244.9379 56.68187 121.2241 307.0505 210.1523 106.0938 221.3220</span></span>
<span><span class="co">## 20 393.5357 305.9833 85.19448 183.1242 451.9880 267.4103 214.5316 252.9693</span></span>
<span><span class="co">## 30 305.2453 275.6055 72.48192 191.9075 345.6258 236.7439 160.3878 229.3451</span></span>
<span><span class="co">##       2.4457   2.4524   2.4574   2.4652   2.4792   2.4911    2.4950   2.5062</span></span>
<span><span class="co">## 10  89.54686 316.8724  97.2490 226.3594 122.1125 99.46151  69.95048 52.76364</span></span>
<span><span class="co">## 20 162.24949 363.8996 114.2504 246.4821 151.0334       NA 130.40406 72.93065</span></span>
<span><span class="co">## 30 142.81038 348.4576 127.0403 294.5955 142.1641 59.25816  84.92042 79.37076</span></span>
<span><span class="co">##      2.5161    2.5227   2.5282   2.5484   2.6525   2.6621   2.6782   2.6928</span></span>
<span><span class="co">## 10       NA  83.72793       NA 107.5707 153.5688 171.0426 172.0216 214.9457</span></span>
<span><span class="co">## 20 91.54536 118.93174 62.65552 144.8924 245.0266 173.3719 279.9866 363.4482</span></span>
<span><span class="co">## 30 71.83690  95.15147       NA 127.9624 184.6375 120.0726 194.0600 258.8668</span></span>
<span><span class="co">##      2.7073   2.7135    2.7339    2.7433   2.7582   2.7800   2.7994   2.8357</span></span>
<span><span class="co">## 10 147.8995 109.8911  77.89777  80.29726 178.3523 161.4813       NA 62.61495</span></span>
<span><span class="co">## 20       NA 187.0658 112.56114 168.48961 230.8484 167.2446 58.19065       NA</span></span>
<span><span class="co">## 30 223.6738 155.9977 116.89987 100.97568 252.2641 316.3822       NA       NA</span></span>
<span><span class="co">##      2.8904   2.9340    2.9413   2.9484   2.9544   2.9627    2.9682    2.9746</span></span>
<span><span class="co">## 10 51.63226 57.14956 121.03776 59.97863 66.45716       NA 118.11881  98.16568</span></span>
<span><span class="co">## 20       NA 65.96537  78.90823 65.07154       NA       NA        NA 101.44219</span></span>
<span><span class="co">## 30       NA 70.23617  79.51779 99.29744       NA 90.71476  84.27174 125.59827</span></span>
<span><span class="co">##      2.9939   3.0184   3.0307   3.0406   3.0491   3.0594   3.0718    3.1144</span></span>
<span><span class="co">## 10       NA 184.7753 341.1048 415.6746 698.5911 291.5051 164.5374  89.18102</span></span>
<span><span class="co">## 20 150.7982 248.2568 460.3224 568.5250 891.9477 417.9655 242.2590 113.06072</span></span>
<span><span class="co">## 30 350.8957 234.2364 416.0586 543.3548 769.5021 343.2626 190.0767 105.18072</span></span>
<span><span class="co">##      3.1369   3.1444   3.1476    3.1575   3.2082   3.2153   3.2320   3.2382</span></span>
<span><span class="co">## 10       NA 65.08866 168.8134  98.41518 1536.217 3769.484 1499.738 1601.331</span></span>
<span><span class="co">## 20       NA 61.83528  88.1025 125.50600 1955.027 3815.274 1963.205 1739.073</span></span>
<span><span class="co">## 30 50.96764       NA 157.3591 125.98021 1902.083 4290.863 1704.133 2543.183</span></span>
<span><span class="co">##      3.2524   3.2673   3.2705   3.2829   3.3019   3.3929    3.4031   3.4083</span></span>
<span><span class="co">## 10 4521.605 2016.903 1534.857 462.2252  95.6325  887.957  865.2127 3128.180</span></span>
<span><span class="co">## 20 4767.033 2511.020 1702.668 561.0364 110.4002 1067.643        NA 3656.465</span></span>
<span><span class="co">## 30 4419.239 2771.662 1955.109 572.1872 103.7590 1367.236 1421.0174 3495.235</span></span>
<span><span class="co">##      3.4186   3.4243   3.4347  3.4445    3.4585   3.4619   3.4681   3.4720</span></span>
<span><span class="co">## 10 2274.073 2532.080 1074.992      NA  979.1747 1053.042 1107.150 1199.189</span></span>
<span><span class="co">## 20 2702.408 2832.234 1493.641      NA 1423.3779 1045.296 1468.777 1351.868</span></span>
<span><span class="co">## 30 2709.228 3323.768 1521.447 264.401 1452.2019 1811.063 1692.697 1945.484</span></span>
<span><span class="co">##      3.4833   3.4880   3.4984   3.5137   3.5312   3.5374   3.5477   3.5539</span></span>
<span><span class="co">## 10 2848.543 711.1614 3030.239 1153.788 830.7520 804.7678 1107.722 1042.157</span></span>
<span><span class="co">## 20 2846.202       NA 3638.346 1235.596 936.8879 847.6891 1232.907 1109.271</span></span>
<span><span class="co">## 30 3233.277 874.4151 3395.337 1316.415 972.2546 981.1855 1321.937 1334.910</span></span>
<span><span class="co">##       3.5646   3.5768   3.5793   3.5905   3.5986   3.6132   3.6206   3.6428</span></span>
<span><span class="co">## 10  968.5097 105.9028 137.8300 131.2571 157.3293 247.7557 176.8860 154.6960</span></span>
<span><span class="co">## 20  900.0694       NA 314.2806 123.6738 138.0719 315.5881 135.0540 170.4805</span></span>
<span><span class="co">## 30 1187.2639       NA 299.4756 140.5175 229.7466 278.5303 205.2608 189.9662</span></span>
<span><span class="co">##      3.6501    3.7042   3.7141   3.7201   3.7237   3.7347   3.7444    3.7540</span></span>
<span><span class="co">## 10 208.4098  999.0931 1415.136 2079.832 1549.022 2578.973 1630.252  900.1247</span></span>
<span><span class="co">## 20 255.5383 1258.9240 1918.302 3194.135 1693.708 3006.940 2043.422 1140.2084</span></span>
<span><span class="co">## 30 278.1656 1159.2642 1639.283 2318.561 2060.678 2769.495 1829.839  880.0378</span></span>
<span><span class="co">##      3.7641   3.7755   3.7836   3.7948   3.8234   3.8270   3.8351   3.8438</span></span>
<span><span class="co">## 10 1256.336 1298.224 2374.140 236.3243 543.4231 752.9224 3346.587 735.0153</span></span>
<span><span class="co">## 20 1596.592 1711.386 2218.180 206.4537 822.1200       NA 4341.257 991.5968</span></span>
<span><span class="co">## 30 1399.624 1505.556 2106.734 265.9667 579.1907 819.1823 3585.849 872.1422</span></span>
<span><span class="co">##       3.8496   3.8528   3.8567   3.8736   3.8888   3.8924   3.9092   3.9128</span></span>
<span><span class="co">## 10  736.9934 1250.343 647.9638 287.8573 1852.677 1898.800 1622.312 1347.827</span></span>
<span><span class="co">## 20 1541.0460 1878.056 692.5062 231.6368 2967.161 2273.967 2889.611 1566.574</span></span>
<span><span class="co">## 30        NA 1597.724 821.7131 266.5514 2256.631 2431.197 2052.016 1669.685</span></span>
<span><span class="co">##      3.9335   3.9493    3.9573   3.9674   3.9741   3.9837   3.9917   4.0020</span></span>
<span><span class="co">## 10 216.5390 118.4627  93.12886 205.4454       NA 227.0910 309.6591 413.9531</span></span>
<span><span class="co">## 20 268.3244 277.0370 102.80916 141.9612 60.42239 256.5561 306.6140 506.7606</span></span>
<span><span class="co">## 30 273.0763 162.3949 103.76528 161.0807 87.12544 230.6408 340.4572 600.5444</span></span>
<span><span class="co">##      4.0107   4.0621    4.0976   4.1091   4.1208   4.1322   4.1508   4.2383</span></span>
<span><span class="co">## 10 230.8845       NA  958.5921 2880.672 2860.118 1008.417       NA       NA</span></span>
<span><span class="co">## 20 228.9913 168.5163 1079.6453 3199.903 3257.002 1245.609       NA 55.71680</span></span>
<span><span class="co">## 30 223.0235 181.8002 1126.9300 3367.654 3409.080 1200.470 144.3914 59.04867</span></span>
<span><span class="co">##      4.2482   4.2567   4.2670    4.2753   4.2812   4.2867   4.2929   4.2991</span></span>
<span><span class="co">## 10       NA 153.4649 65.58097 108.30387 236.6605 233.2040 137.3656 477.9401</span></span>
<span><span class="co">## 20 97.47676 145.9449 79.81083  90.43372 319.0321 293.0553 279.0271       NA</span></span>
<span><span class="co">## 30 79.35567 129.3182 91.64852 112.55492 267.4957 280.5112 200.6799       NA</span></span>
<span><span class="co">##     4.3145   4.3266    4.3308  4.3412    4.4380   4.4454   4.4534   4.5311</span></span>
<span><span class="co">## 10      NA       NA  78.66504 72.8259  98.09875 246.2942 103.3528 55.33868</span></span>
<span><span class="co">## 20      NA 169.1433 110.84330 78.1489 136.49986 260.4065 139.4042       NA</span></span>
<span><span class="co">## 30 84.4526       NA  64.31592      NA 117.17094 228.3749 124.2998       NA</span></span>
<span><span class="co">##      4.5533    4.5638   4.5701   4.5754   4.5907  5.0976   5.2369   5.2431</span></span>
<span><span class="co">## 10       NA 1229.6744       NA       NA 463.1378      NA 1817.439 1847.273</span></span>
<span><span class="co">## 20 57.07270  120.5828       NA       NA       NA      NA 2330.003 2200.440</span></span>
<span><span class="co">## 30 58.74335        NA 206.5203 63.23561       NA  126.32 1957.950 2036.357</span></span>
<span><span class="co">##      5.2827   5.2934   5.3025   5.3159   5.3752   5.6172   5.7651   5.7807</span></span>
<span><span class="co">## 10       NA 523.6252 234.5118 85.61688       NA 65.78881       NA       NA</span></span>
<span><span class="co">## 20 902.7376       NA 441.4214       NA 110.2352       NA 55.28224 82.36989</span></span>
<span><span class="co">## 30 445.7218 253.6866       NA 98.27617       NA       NA       NA       NA</span></span>
<span><span class="co">##      5.8694   5.8898   5.9157   6.0122    6.0161   6.1030   6.1124   6.1346</span></span>
<span><span class="co">## 10       NA       NA       NA       NA 11787.199 116.5275 123.0397       NA</span></span>
<span><span class="co">## 20       NA       NA       NA 4678.138  8102.819 145.0754 129.1509       NA</span></span>
<span><span class="co">## 30 65.83419 77.36537 88.34489       NA 12569.618 125.2200 123.6173 53.95125</span></span>
<span><span class="co">##      6.9010   6.9154   7.1032    7.1041   7.1088   7.1194   7.1928   7.2038</span></span>
<span><span class="co">## 10 122.8229 134.3873       NA        NA 156.3402       NA 189.0228 165.3699</span></span>
<span><span class="co">## 20 146.0084 220.0099       NA  59.30034       NA 108.1284 225.4606       NA</span></span>
<span><span class="co">## 30 142.6998 161.2664 77.06098 253.87997 247.2530       NA 202.5599       NA</span></span>
<span><span class="co">##      7.2068   7.2182   7.2497    7.2772    7.2895   7.3010   7.3281   7.3317</span></span>
<span><span class="co">## 10 247.7746 102.8240       NA 110.38725  95.47776 51.04997 119.7981 202.3012</span></span>
<span><span class="co">## 20 370.2237 118.3368 62.58484  91.56676 127.29960       NA       NA 340.4834</span></span>
<span><span class="co">## 30 348.4244 108.6484       NA  88.71859 143.25897 64.29371       NA 334.5977</span></span>
<span><span class="co">##      7.3409   7.3817   7.3941    7.4211   7.4340   7.4462   7.5415   7.5550</span></span>
<span><span class="co">## 10 195.5841       NA 55.65825  89.04767 101.8156       NA 74.46896 82.79328</span></span>
<span><span class="co">## 20 139.4118       NA 73.21077 102.33101 162.8226 75.26130 69.41431 88.77966</span></span>
<span><span class="co">## 30 187.3697 54.11669 59.22345  96.57208 149.4560 75.29813 77.55390 89.19004</span></span>
<span><span class="co">##       7.7343   7.7476   7.8720   7.8856    7.9094   7.9182   7.9252   7.9431</span></span>
<span><span class="co">## 10 101.52235 89.79723       NA 50.47836 105.81927 143.7226 80.66585       NA</span></span>
<span><span class="co">## 20  95.25360 86.37586 54.15297       NA  77.99911       NA       NA 53.88289</span></span>
<span><span class="co">## 30  95.99036 80.57030       NA       NA  91.60336 110.0937       NA       NA</span></span>
<span><span class="co">##      8.2017   8.2182   8.2202   8.2457   8.3523   8.4610  -0.0003  -0.1483</span></span>
<span><span class="co">## 10 157.1990       NA 159.2339 186.2074 234.8404       NA 16859.11 54.34652</span></span>
<span><span class="co">## 20 196.4877 208.1011 146.5433 208.4713 222.3893 54.51042 16799.60       NA</span></span>
<span><span class="co">## 30 169.1293       NA 185.7654 190.7122 269.4926 55.56134 18104.35       NA</span></span>
<span><span class="co">##     -0.1683  -0.1878  -0.2327</span></span>
<span><span class="co">## 10       NA       NA       NA</span></span>
<span><span class="co">## 20       NA       NA 51.43338</span></span>
<span><span class="co">## 30 70.11231 60.50172       NA</span></span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">peak_table</span>, <span class="st">"demo_peak_table.rds"</span><span class="op">)</span></span></code></pre></div>
<p>From this peak table you can proceed to use statistical testing,
machine learning, and any downstream analysis you may be interested
in.</p>
<!--

See `vignette("Vig04-from-peak-table-to-differential-analysis", package = "AlpsNMR")`
for more.
-->
</div>
<div class="section level2">
<h2 id="session-info">Session Info:<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 20.04.4 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] AlpsNMR_3.99.2      future_1.28.0       BiocParallel_1.30.4</span></span>
<span><span class="co">## [4] readxl_1.4.1        ggplot2_3.3.6       dplyr_1.0.10       </span></span>
<span><span class="co">## [7] BiocStyle_2.24.0   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] matrixStats_0.62.0     fs_1.5.2               httr_1.4.4            </span></span>
<span><span class="co">##   [4] RColorBrewer_1.1-3     rprojroot_2.0.3        doRNG_1.8.2           </span></span>
<span><span class="co">##   [7] tools_4.2.1            bslib_0.4.0            utf8_1.2.2            </span></span>
<span><span class="co">##  [10] R6_2.5.1               colorspace_2.0-3       withr_2.5.0           </span></span>
<span><span class="co">##  [13] tidyselect_1.2.0       gridExtra_2.3          MassSpecWavelet_1.62.0</span></span>
<span><span class="co">##  [16] compiler_4.2.1         progressr_0.11.0       rvest_1.0.3           </span></span>
<span><span class="co">##  [19] textshaping_0.3.6      cli_3.4.1              SparseM_1.81          </span></span>
<span><span class="co">##  [22] xml2_1.3.3             desc_1.4.2             labeling_0.4.2        </span></span>
<span><span class="co">##  [25] bookdown_0.29          sass_0.4.2             scales_1.2.1          </span></span>
<span><span class="co">##  [28] mvtnorm_1.1-3          randomForest_4.7-1.1   quadprog_1.5-8        </span></span>
<span><span class="co">##  [31] pkgdown_2.0.6          systemfonts_1.0.4      stringr_1.4.1         </span></span>
<span><span class="co">##  [34] digest_0.6.29          rmarkdown_2.17         pkgconfig_2.0.3       </span></span>
<span><span class="co">##  [37] htmltools_0.5.3        parallelly_1.32.1      itertools_0.1-3       </span></span>
<span><span class="co">##  [40] fastmap_1.1.0          highr_0.9              rlang_1.0.6           </span></span>
<span><span class="co">##  [43] impute_1.70.0          jquerylib_0.1.4        generics_0.1.3        </span></span>
<span><span class="co">##  [46] farver_2.1.1           jsonlite_1.8.2         speaq_2.7.0           </span></span>
<span><span class="co">##  [49] magrittr_2.0.3         Matrix_1.5-1           Rcpp_1.0.9            </span></span>
<span><span class="co">##  [52] munsell_0.5.0          fansi_1.0.3            RcppZiggurat_0.1.6    </span></span>
<span><span class="co">##  [55] lifecycle_1.0.3        stringi_1.7.8          yaml_2.3.5            </span></span>
<span><span class="co">##  [58] MASS_7.3-58.1          plyr_1.8.7             grid_4.2.1            </span></span>
<span><span class="co">##  [61] parallel_4.2.1         listenv_0.8.0          ggrepel_0.9.1         </span></span>
<span><span class="co">##  [64] doSNOW_1.0.20          crayon_1.5.2           lattice_0.20-45       </span></span>
<span><span class="co">##  [67] cowplot_1.1.1          knitr_1.40             pillar_1.8.1          </span></span>
<span><span class="co">##  [70] igraph_1.3.5           rngtools_1.5.2         corpcor_1.6.10        </span></span>
<span><span class="co">##  [73] reshape2_1.4.4         codetools_0.2-18       mixOmics_6.20.0       </span></span>
<span><span class="co">##  [76] lpSolve_5.6.17         glue_1.6.2             evaluate_0.17         </span></span>
<span><span class="co">##  [79] data.table_1.14.2      BiocManager_1.30.18    missForest_1.5        </span></span>
<span><span class="co">##  [82] foreach_1.5.2          vctrs_0.4.2            cellranger_1.1.0      </span></span>
<span><span class="co">##  [85] gtable_0.3.1           purrr_0.3.5            tidyr_1.2.1           </span></span>
<span><span class="co">##  [88] cachem_1.0.6           xfun_0.33              limSolve_1.5.6        </span></span>
<span><span class="co">##  [91] Rfast_2.0.6            RSpectra_0.16-1        baseline_1.3-4        </span></span>
<span><span class="co">##  [94] ragg_1.2.3             pcaPP_2.0-2            rARPACK_0.11-0        </span></span>
<span><span class="co">##  [97] signal_0.7-7           tibble_3.1.8           snow_0.4-4            </span></span>
<span><span class="co">## [100] iterators_1.0.14       memoise_2.0.1          ellipse_0.4.3         </span></span>
<span><span class="co">## [103] cluster_2.1.4          globals_0.16.1         ellipsis_0.3.2</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ivan Montoliu Roura, Sergio Oller Moreno, Francisco Madrid Gambin, Luis Fernandez, Héctor Gracia Cabrera, Santiago Marco Colás.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
