<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to AlpsNMR • AlpsNMR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to AlpsNMR">
<meta property="og:description" content="AlpsNMR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AlpsNMR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction-to-alpsnmr.html">AlpsNMR Workflow
</a>
    </li>
    <li>
      <a href="../articles/tutorial_MTBLS242.html">AlpsNMR tutorial
</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sipss/AlpsNMR" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to AlpsNMR</h1>
                        <h4 data-toc-skip class="author">Sergio Oller,
Institute for Bioengineering of Catalonia</h4>
            
            <h4 data-toc-skip class="date">2022-06-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sipss/AlpsNMR/blob/HEAD/vignettes/introduction-to-alpsnmr.Rmd" class="external-link"><code>vignettes/introduction-to-alpsnmr.Rmd</code></a></small>
      <div class="hidden name"><code>introduction-to-alpsnmr.Rmd</code></div>

    </div>

    
    
<p>The <code>AlpsNMR</code> package was written with two purposes in
mind:</p>
<ul>
<li>to help <strong>data analysts and NMR scientists</strong> to work
with NMR samples.</li>
<li>to help <strong>IT pipeline builders</strong> implement automated
methods for preprocessing.</li>
</ul>
<p>Functions from this package written for data analysts and NMR
scientists are prefixed with <code>nmr_</code>, while higher level
functions written for IT pipeline builders are prefixed with
<code>pipe_</code>. The main reason why all exported functions have a
prefix is to make it easy for the user to discover the functions from
the package. By typing nmr_ RStudio will return the list of exported
functions. In the R terminal, nmr_ followed by the tab key (⇥) twice
will have the same effect. Other popular packages, follow similar
approaches (e.g: <code>forcats</code>: <code>fct_*</code>,
<code>stringr</code>: <code>str_*</code>).</p>
<p>This vignette is written for the first group. It assumes some prior
basic knowledge of NMR and data analysis, as well as some basic R
programming. In case you are interested in building pipelines with this
package, you may want to open the file saved in this directory (run it
on your computer):</p>
<pre><code><span class="va">pipeline_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"pipeline-rmd"</span>, <span class="st">"pipeline_example.R"</span>, package <span class="op">=</span> <span class="st">"AlpsNMR"</span><span class="op">)</span>
<span class="va">pipeline_example</span></code></pre>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sipss.github.io/AlpsNMR/" class="external-link">AlpsNMR</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: dplyr</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="co">#&gt; Loading required package: future</span>
<span class="co">#&gt; Loading required package: magrittr</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="enable-parallellization">Enable parallellization<a class="anchor" aria-label="anchor" href="#enable-parallellization"></a>
</h2>
<p>This package is able to parallellize several functions through the
use of the <code>BiocParallel</code> package. Whether to parallelize or
not is left to the user that can control the parallellization
registering backends. Please check the <code>BiocParallel</code>
introduction for further details</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span>
<span class="co">#register(SerialParam(), default = TRUE)  # disable parallellization</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SnowParam-class.html" class="external-link">SnowParam</a></span><span class="op">(</span>workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, default <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># enable parallellization with 4 workers</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-the-meoh_plasma_extraction-dataset">Data: The <code>MeOH_plasma_extraction</code> dataset<a class="anchor" aria-label="anchor" href="#data-the-meoh_plasma_extraction-dataset"></a>
</h2>
<p>To explore the basics of the AlpsNMR package, we have included four
NMR samples acquired in a 600 MHz Bruker instrument bundled with the
package. The samples are pooled quality control plasma samples, that
were extracted with methanol, and therefore only contain small
molecules.</p>
<p>If you have installed this package, you can obtain the directory
where the four samples are with the command</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MeOH_plasma_extraction_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"dataset-demo"</span>, package <span class="op">=</span> <span class="st">"AlpsNMR"</span><span class="op">)</span>
<span class="va">MeOH_plasma_extraction_dir</span>
<span class="co">#&gt; [1] "/__w/_temp/Library/AlpsNMR/dataset-demo"</span></code></pre></div>
<p>The demo directory includes four samples (zipped) and a dummy Excel
metadata file.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html" class="external-link">dir_ls</a></span><span class="op">(</span><span class="va">MeOH_plasma_extraction_dir</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #BB0000; font-weight: bold;">/__w/_temp/Library/AlpsNMR/dataset-demo/10.zip</span></span>
<span class="co">#&gt; <span style="color: #BB0000; font-weight: bold;">/__w/_temp/Library/AlpsNMR/dataset-demo/20.zip</span></span>
<span class="co">#&gt; <span style="color: #BB0000; font-weight: bold;">/__w/_temp/Library/AlpsNMR/dataset-demo/30.zip</span></span>
<span class="co">#&gt; /__w/_temp/Library/AlpsNMR/dataset-demo/README.txt</span>
<span class="co">#&gt; /__w/_temp/Library/AlpsNMR/dataset-demo/dummy_metadata.xlsx</span></code></pre></div>
<p>Given the name of the dataset, one may guess that the dataset was
used to check the Methanol extraction in serum samples. The dummy
metadata consists of dummy information, just for the sake of showing how
this package can integrate external metadata. The excel file consists of
two tidy tables, in two sheets.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MeOH_plasma_extraction_xlsx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">MeOH_plasma_extraction_dir</span>, <span class="st">"dummy_metadata.xlsx"</span><span class="op">)</span>
<span class="va">exp_subj_id</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">MeOH_plasma_extraction_xlsx</span>, sheet <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">subj_id_age</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">MeOH_plasma_extraction_xlsx</span>, sheet <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">exp_subj_id</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span>
<span class="co">#&gt;   NMRExperiment SubjectID TimePoint</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 10            Ana       baseline </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 20            Ana       3 months </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 30            Elia      baseline</span>
<span class="va">subj_id_age</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="co">#&gt;   SubjectID   Age</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Ana          29</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Elia          0</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="loading-samples">Loading samples<a class="anchor" aria-label="anchor" href="#loading-samples"></a>
</h2>
<p>The function to read samples is called <code>nmr_read_samples</code>.
It expects a character vector with the samples to load that can be paths
to directories of Bruker format samples or paths to JDX files.</p>
<p>Additionally, this function can filter by pulse sequences (e.g. load
only NOESY samples) or loading only metadata.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">zip_files</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html" class="external-link">dir_ls</a></span><span class="op">(</span><span class="va">MeOH_plasma_extraction_dir</span>, glob <span class="op">=</span> <span class="st">"*.zip"</span><span class="op">)</span>
<span class="va">zip_files</span>
<span class="co">#&gt; <span style="color: #BB0000; font-weight: bold;">/__w/_temp/Library/AlpsNMR/dataset-demo/10.zip</span></span>
<span class="co">#&gt; <span style="color: #BB0000; font-weight: bold;">/__w/_temp/Library/AlpsNMR/dataset-demo/20.zip</span></span>
<span class="co">#&gt; <span style="color: #BB0000; font-weight: bold;">/__w/_temp/Library/AlpsNMR/dataset-demo/30.zip</span></span>
<span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_read_samples.html">nmr_read_samples</a></span><span class="op">(</span>sample_names <span class="op">=</span> <span class="va">zip_files</span><span class="op">)</span>
<span class="va">dataset</span>
<span class="co">#&gt; An nmr_dataset (3 samples)</span></code></pre></div>
<p>As we have not added any metadata to this dataset, the only column we
see is the <code>NMRExperiment</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/nmr_meta_get.html">nmr_meta_get</a></span><span class="op">(</span><span class="va">dataset</span>, groups <span class="op">=</span> <span class="st">"external"</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 1</span></span>
<span class="co">#&gt;   NMRExperiment</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 10           </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 20           </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 30</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adding-metadata">Adding metadata<a class="anchor" aria-label="anchor" href="#adding-metadata"></a>
</h2>
<p>Initally our dataset only has the <code>NMRExperiment</code>
column:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/nmr_meta_get.html">nmr_meta_get</a></span><span class="op">(</span><span class="va">dataset</span>, groups <span class="op">=</span> <span class="st">"external"</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 1</span></span>
<span class="co">#&gt;   NMRExperiment</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 10           </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 20           </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 30</span></code></pre></div>
<p>The <code>exp_subj_id</code> table we loaded links the
<code>NMRExperiment</code> to the <code>SubjectID</code>.</p>
<p>As we already have the <code>NMRExperiment</code> column, we can use
it as the merging column (note that both columns have the same column
name to match the metadata such as group class, age, BMI…):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_meta_add.html">nmr_meta_add</a></span><span class="op">(</span><span class="va">dataset</span>, metadata <span class="op">=</span> <span class="va">exp_subj_id</span>, by <span class="op">=</span> <span class="st">"NMRExperiment"</span><span class="op">)</span>
<span class="fu"><a href="../reference/nmr_meta_get.html">nmr_meta_get</a></span><span class="op">(</span><span class="va">dataset</span>, groups <span class="op">=</span> <span class="st">"external"</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span>
<span class="co">#&gt;   NMRExperiment SubjectID TimePoint</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 10            Ana       baseline </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 20            Ana       3 months </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 30            Elia      baseline</span></code></pre></div>
<p>If we have info from different files we can match them. For instance,
now we have the <code>SubjectID</code> information so we can add the
table that adds the <code>SubjectID</code> to the <code>Age</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_meta_add.html">nmr_meta_add</a></span><span class="op">(</span><span class="va">dataset</span>, metadata <span class="op">=</span> <span class="va">subj_id_age</span>, by <span class="op">=</span> <span class="st">"SubjectID"</span><span class="op">)</span>
<span class="fu"><a href="../reference/nmr_meta_get.html">nmr_meta_get</a></span><span class="op">(</span><span class="va">dataset</span>, groups <span class="op">=</span> <span class="st">"external"</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span>
<span class="co">#&gt;   NMRExperiment SubjectID TimePoint   Age</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 10            Ana       baseline     29</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 20            Ana       3 months     29</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 30            Elia      baseline      0</span></code></pre></div>
<p>Now we have our metadata integrated in the dataset and we can make
use of it in further data analysis steps.</p>
</div>
<div class="section level2">
<h2 id="interpolation">Interpolation<a class="anchor" aria-label="anchor" href="#interpolation"></a>
</h2>
<p>1D NMR samples can be interpolated together, in order to arrange all
the spectra into a matrix, with one row per sample. The main parameters
we would need is the range of ppm values that we want to interpolate and
the resolution.</p>
<p>We can see the ppm resolution by looking at the ppm axis of one
sample:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ppm_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_ppm_resolution.html">nmr_ppm_resolution</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"The ppm resolution is: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">ppm_res</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">" ppm"</span><span class="op">)</span>
<span class="co">#&gt; The ppm resolution is: 0.00023 ppm</span></code></pre></div>
<p>We can interpolate the dataset, obtaining an
<code>nmr_dataset_1D</code> object:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_interpolate_1D.html">nmr_interpolate_1D</a></span><span class="op">(</span><span class="va">dataset</span>, axis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>min <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">2.3E-4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>This operation changes the class of the object, as now the data is on
a matrix. The dataset is now of class <code>nmr_dataset_1D</code>. The
<code>axis</code> element is now a numeric vector and the
<code>data_1r</code> element is a matrix.</p>
</div>
<div class="section level2">
<h2 id="plotting-samples">Plotting samples<a class="anchor" aria-label="anchor" href="#plotting-samples"></a>
</h2>
<p>The <code>AlpsNMR</code> package offers the possibility to plot
<code>nmr_dataset_1D</code> objects. Plotting many spectra with so many
points is quite expensive so it is possible to include only some regions
of the spectra or plot only some samples.</p>
<p>Use <code><a href="../reference/plot.nmr_dataset_1D.html">?plot.nmr_dataset_1D</a></code> to check the parameters, among
them:</p>
<ul>
<li>
<code>NMRExperiment</code>: A character vector with the NMR
experiments to plot</li>
<li>
<code>chemshift_range</code>: A ppm range to plot only a small
region, or to reduce the resolution</li>
<li>
<code>interactive</code>: To make the plot interactive -
<code>...</code>: Can be used to pass additional parameters such as
<code>color = "SubjectID"</code> that are passed as aesthetics to
ggplot.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, NMRExperiment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10"</span>, <span class="st">"30"</span><span class="op">)</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.2</span>, <span class="fl">2.8</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<div class="section level3">
<h3 id="creating-interactive-plots">Creating interactive plots<a class="anchor" aria-label="anchor" href="#creating-interactive-plots"></a>
</h3>
<p>The option <code>interactive = TRUE</code> described above has some
performance limitations. As high performance workaround, you can make
many plots interactive with the function
<code>plot_interactive</code>.</p>
<p>This function will use WebGL technologies to create a webpage that,
once opened, allows you to interact with the plot.</p>
<p>Due to technical limitations, these plots need to be opened manually
and can’t be embedded in RMarkdown documents. Therefore, the function
saves the plot in the directory for further exploration. Additionally,
some old web browsers may not be able to display these interactive plots
correctly.</p>
<pre><code><span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, NMRExperiment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10"</span>, <span class="st">"30"</span><span class="op">)</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.2</span>, <span class="fl">2.8</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_interactive.html">plot_interactive</a></span><span class="op">(</span><span class="va">plt</span>, <span class="st">"plot_region.html"</span><span class="op">)</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="exclude-regions">Exclude regions<a class="anchor" aria-label="anchor" href="#exclude-regions"></a>
</h2>
<p>Some regions can easily be excluded from the spectra with
<code>nmr_exclude_region</code>. Note that the regions are fully removed
and not zeroed, as using zeros complicates a lot the implementation<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> and has
little advantages.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">regions_to_exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>water <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.6</span>, <span class="fl">5</span><span class="op">)</span>, methanol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.33</span>, <span class="fl">3.39</span><span class="op">)</span><span class="op">)</span>
<span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_exclude_region.html">nmr_exclude_region</a></span><span class="op">(</span><span class="va">dataset</span>, exclude <span class="op">=</span> <span class="va">regions_to_exclude</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.2</span>, <span class="fl">5.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="filter-samples">Filter samples<a class="anchor" aria-label="anchor" href="#filter-samples"></a>
</h2>
<p>Maybe we just want to analyze a subset of the data, e.g., only a
class group or a particular gender. We can filter some samples according
to their metadata as follows:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">samples_10_20</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">SubjectID</span> <span class="op">==</span> <span class="st">"Ana"</span><span class="op">)</span>
<span class="fu"><a href="../reference/nmr_meta_get.html">nmr_meta_get</a></span><span class="op">(</span><span class="va">samples_10_20</span>, groups <span class="op">=</span> <span class="st">"external"</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span>
<span class="co">#&gt;   NMRExperiment SubjectID TimePoint   Age</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 10            Ana       baseline     29</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 20            Ana       3 months     29</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="robust-pca-for-outlier-detection">Robust PCA for outlier detection<a class="anchor" aria-label="anchor" href="#robust-pca-for-outlier-detection"></a>
</h2>
<p>The AlpsNMR package includes robust PCA analysis for outlier
detection. With such a small demo dataset, it is not practical to use,
but check out the documentation of <code>nmr_pca_outliers_*</code>
functions.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pca_outliers_rob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_pca_outliers_robust.html">nmr_pca_outliers_robust</a></span><span class="op">(</span><span class="va">dataset</span>, ncomp <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/nmr_pca_outliers_plot.html">nmr_pca_outliers_plot</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">pca_outliers_rob</span><span class="op">)</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="baseline-removal">Baseline removal<a class="anchor" aria-label="anchor" href="#baseline-removal"></a>
</h2>
<p>Spectra may display an unstable baseline, specially when processing
blood/fecal blood/fecal samples. If so,
<code>nmr_baseline_removal</code> subtract the baseline by means of
Asymmetric Least Squares method.</p>
<p>See before:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>,<span class="fl">3.8</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>And after:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset</span> <span class="op">=</span> <span class="fu"><a href="../reference/nmr_baseline_removal.html">nmr_baseline_removal</a></span><span class="op">(</span><span class="va">dataset</span>, lambda <span class="op">=</span> <span class="fl">6</span>, p <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>,<span class="fl">3.8</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="peak-detection">Peak detection<a class="anchor" aria-label="anchor" href="#peak-detection"></a>
</h2>
<p>The peak detection is performed on short spectra segments using a
continuous wavelet transform. See <code><a href="../reference/nmr_detect_peaks.html">?nmr_detect_peaks</a></code> for
more information.</p>
<p>Our current approach relies on the use of the baseline threshold
(<code>baselineThresh</code>) automatic calculated (see
<code><a href="../reference/nmr_baseline_threshold.html">?nmr_baseline_threshold</a></code>) and the Signal to Noise Threshold
(<code>SNR.Th</code>) to discriminate valid peaks from noise.</p>
<p>The combination of the <code>baselineThresh</code> and the
<code>SNR.Th</code> optimizes the number of actual peaks from noise.</p>
<p>The advantage of the <code>SNR.Th</code> method is that it estimates
the noise level on each spectra region independently, so in practice it
can be used as a dynamic baseline threshold level.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_detect_peaks.html">nmr_detect_peaks</a></span><span class="op">(</span>
    <span class="va">dataset</span>,
    nDivRange_ppm <span class="op">=</span> <span class="fl">0.1</span>,
    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,
    baselineThresh <span class="op">=</span> <span class="cn">NULL</span>,
    SNR.Th <span class="op">=</span> <span class="fl">3</span>
<span class="op">)</span>
<span class="va">NMRExp_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_align_find_ref.html">nmr_align_find_ref</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">peak_table</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Your reference is NMRExperiment "</span>, <span class="va">NMRExp_ref</span><span class="op">)</span>
<span class="co">#&gt; Your reference is NMRExperiment 30</span>
<span class="fu"><a href="../reference/nmr_detect_peaks_plot.html">nmr_detect_peaks_plot</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">peak_table</span>, NMRExperiment <span class="op">=</span> <span class="st">"20"</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>,<span class="fl">3.8</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="spectra-alignment">Spectra alignment<a class="anchor" aria-label="anchor" href="#spectra-alignment"></a>
</h2>
<p>To align the sample, we use the <code>nmr_align</code> function,
which in turn uses a hierarchical clustering method (see
<code><a href="../reference/nmr_align.html">?nmr_align</a></code> for further details).</p>
<p>The <code>maxShift_ppm</code> limits the maximum shift allowed for
the spectra.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nmr_exp_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_align_find_ref.html">nmr_align_find_ref</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">peak_table</span><span class="op">)</span>
<span class="va">dataset_align</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_align.html">nmr_align</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">peak_table</span>, <span class="va">nmr_exp_ref</span>, maxShift_ppm <span class="op">=</span> <span class="fl">0.0015</span>, acceptLostPeak <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.025</span>, <span class="fl">3.063</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset_align</span>, chemshift_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.025</span>, <span class="fl">3.063</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-20-2.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="normalization">Normalization<a class="anchor" aria-label="anchor" href="#normalization"></a>
</h2>
<p>There are multiple normalization techniques available. The most
strongly recommended is the <code>pqn</code> normalization, but it may
not be fully reliable when the number of samples is small, as it needs a
computation of the median spectra. Nevertheless, it is possible to
compute it:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_normalize.html">nmr_normalize</a></span><span class="op">(</span><span class="va">dataset_align</span>, method <span class="op">=</span> <span class="st">"pqn"</span><span class="op">)</span>
<span class="co">#&gt; Warning in norm_pqn(samples[["data_1r"]]): The Probabalistic Quotient</span>
<span class="co">#&gt; Normalization requires several samples to compute the median spectra. Your</span>
<span class="co">#&gt; number of samples is low</span></code></pre></div>
<p>The <code>AlpsNMR</code> package offers the possibility to extract
additional normalization information with
<code>nmr_normalize_extra_info(dataset)</code>, to explore the
normalization factors applied to each sample:</p>
<p>The plot shows the dispersion with respect to the median of the
normalization factors, and can highlight samples with abnormaly large or
small normalization factors.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagnostic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_normalize.html">nmr_normalize_extra_info</a></span><span class="op">(</span><span class="va">dataset_norm</span><span class="op">)</span>
<span class="va">diagnostic</span><span class="op">$</span><span class="va">norm_factor</span>
<span class="co">#&gt;   NMRExperiment norm_factor norm_factor_norm</span>
<span class="co">#&gt; 1            10   520824787        0.8706957</span>
<span class="co">#&gt; 2            20   689300837        1.1523478</span>
<span class="co">#&gt; 3            30   598170829        1.0000000</span>
<span class="va">diagnostic</span><span class="op">$</span><span class="va">plot</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="peak-integration">Peak integration<a class="anchor" aria-label="anchor" href="#peak-integration"></a>
</h2>
<div class="section level3">
<h3 id="integration-based-on-peak-center-and-width">1. Integration based on peak center and width<a class="anchor" aria-label="anchor" href="#integration-based-on-peak-center-and-width"></a>
</h3>
<p>If we want to integrate the whole spectra, we need ppm from the
<code>peak_table</code>. See <code>Peak detection</code> section. The
function <code>nmr_integrate_peak_positions</code> generates a new
<code>nmr_dataset_1D</code> object containing the integrals from the
<code>peak_table</code> (ppm values corresponding to detected
peaks).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table_integration</span> <span class="op">=</span> <span class="fu"><a href="../reference/nmr_integrate_peak_positions.html">nmr_integrate_peak_positions</a></span><span class="op">(</span>
  samples <span class="op">=</span> <span class="va">dataset_norm</span>,
  peak_pos_ppm <span class="op">=</span> <span class="va">peak_table</span><span class="op">$</span><span class="va">ppm</span>,
  peak_width_ppm <span class="op">=</span> <span class="fl">0.006</span><span class="op">)</span>
<span class="co">#&gt; New names:</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_-0.0002` -&gt; `ppm_-0.0002...3`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8607` -&gt; `ppm_0.8607...17`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8655` -&gt; `ppm_0.8655...18`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8729` -&gt; `ppm_0.8729...19`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8784` -&gt; `ppm_0.8784...20`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8910` -&gt; `ppm_0.8910...21`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9032` -&gt; `ppm_0.9032...22`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9085` -&gt; `ppm_0.9085...23`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9196` -&gt; `ppm_0.9196...25`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9313` -&gt; `ppm_0.9313...26`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9437` -&gt; `ppm_0.9437...27`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9554` -&gt; `ppm_0.9554...28`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9658` -&gt; `ppm_0.9658...29`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9902` -&gt; `ppm_0.9902...31`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0019` -&gt; `ppm_1.0019...32`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0093` -&gt; `ppm_1.0093...33`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0208` -&gt; `ppm_1.0208...34`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0410` -&gt; `ppm_1.0410...35`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0716` -&gt; `ppm_1.0716...38`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0803` -&gt; `ppm_1.0803...39`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.1505` -&gt; `ppm_1.1505...41`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.1979` -&gt; `ppm_1.1979...42`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.2084` -&gt; `ppm_1.2084...43`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.2179` -&gt; `ppm_1.2179...44`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.3262` -&gt; `ppm_1.3262...49`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.3377` -&gt; `ppm_1.3377...50`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.4424` -&gt; `ppm_1.4424...52`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.4913` -&gt; `ppm_1.4913...54`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.5693` -&gt; `ppm_1.5693...60`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6195` -&gt; `ppm_1.6195...65`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6443` -&gt; `ppm_1.6443...68`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6562` -&gt; `ppm_1.6562...70`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6799` -&gt; `ppm_1.6799...73`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6990` -&gt; `ppm_1.6990...79`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.7351` -&gt; `ppm_1.7351...85`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.7614` -&gt; `ppm_1.7614...88`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.8131` -&gt; `ppm_1.8131...90`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.8748` -&gt; `ppm_1.8748...96`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.9210` -&gt; `ppm_1.9210...99`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.9313` -&gt; `ppm_1.9313...100`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0026` -&gt; `ppm_2.0026...107`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0194` -&gt; `ppm_2.0194...110`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0307` -&gt; `ppm_2.0307...111`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0422` -&gt; `ppm_2.0422...112`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0806` -&gt; `ppm_2.0806...116`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1149` -&gt; `ppm_2.1149...119`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1192` -&gt; `ppm_2.1192...120`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1273` -&gt; `ppm_2.1273...121`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1324` -&gt; `ppm_2.1324...122`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1572` -&gt; `ppm_2.1572...127`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1655` -&gt; `ppm_2.1655...128`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.2835` -&gt; `ppm_2.2835...136`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.2950` -&gt; `ppm_2.2950...137`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3251` -&gt; `ppm_2.3251...140`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3451` -&gt; `ppm_2.3451...142`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3513` -&gt; `ppm_2.3513...143`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3575` -&gt; `ppm_2.3575...144`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3644` -&gt; `ppm_2.3644...145`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3711` -&gt; `ppm_2.3711...146`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.4196` -&gt; `ppm_2.4196...150`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.4912` -&gt; `ppm_2.4912...159`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.4953` -&gt; `ppm_2.4953...160`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.5284` -&gt; `ppm_2.5284...164`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.6216` -&gt; `ppm_2.6216...170`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.7577` -&gt; `ppm_2.7577...181`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.9332` -&gt; `ppm_2.9332...192`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.0305` -&gt; `ppm_3.0305...199`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.0404` -&gt; `ppm_3.0404...200`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.0489` -&gt; `ppm_3.0489...201`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2081` -&gt; `ppm_3.2081...211`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2154` -&gt; `ppm_3.2154...212`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2320` -&gt; `ppm_3.2320...213`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2382` -&gt; `ppm_3.2382...214`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2672` -&gt; `ppm_3.2672...216`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2706` -&gt; `ppm_3.2706...217`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.4031` -&gt; `ppm_3.4031...221`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.4243` -&gt; `ppm_3.4243...224`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.4829` -&gt; `ppm_3.4829...231`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.4981` -&gt; `ppm_3.4981...233`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.5135` -&gt; `ppm_3.5135...234`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.5372` -&gt; `ppm_3.5372...236`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7042` -&gt; `ppm_3.7042...247`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7141` -&gt; `ppm_3.7141...248`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7200` -&gt; `ppm_3.7200...249`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7237` -&gt; `ppm_3.7237...250`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7348` -&gt; `ppm_3.7348...251`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7442` -&gt; `ppm_3.7442...252`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7757` -&gt; `ppm_3.7757...255`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.8233` -&gt; `ppm_3.8233...258`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.8438` -&gt; `ppm_3.8438...261`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.8528` -&gt; `ppm_3.8528...263`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.8886` -&gt; `ppm_3.8886...266`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.8923` -&gt; `ppm_3.8923...267`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.9091` -&gt; `ppm_3.9091...268`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.9128` -&gt; `ppm_3.9128...269`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.9333` -&gt; `ppm_3.9333...270`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.9493` -&gt; `ppm_3.9493...271`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.9917` -&gt; `ppm_3.9917...275`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.0020` -&gt; `ppm_4.0020...276`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.0108` -&gt; `ppm_4.0108...277`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.1205` -&gt; `ppm_4.1205...281`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.1320` -&gt; `ppm_4.1320...282`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.1927` -&gt; `ppm_4.1927...284`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.2281` -&gt; `ppm_4.2281...286`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.2398` -&gt; `ppm_4.2398...288`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.2566` -&gt; `ppm_4.2566...292`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.4376` -&gt; `ppm_4.4376...304`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.4531` -&gt; `ppm_4.4531...306`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.5218` -&gt; `ppm_4.5218...309`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.5221` -&gt; `ppm_4.5221...310`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.5906` -&gt; `ppm_4.5906...313`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_5.2369` -&gt; `ppm_5.2369...317`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_5.4154` -&gt; `ppm_5.4154...323`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_6.1026` -&gt; `ppm_6.1026...335`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_6.9009` -&gt; `ppm_6.9009...343`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_6.9154` -&gt; `ppm_6.9154...344`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.2894` -&gt; `ppm_7.2894...353`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.3014` -&gt; `ppm_7.3014...354`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.3409` -&gt; `ppm_7.3409...357`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.3816` -&gt; `ppm_7.3816...361`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.4881` -&gt; `ppm_7.4881...367`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.5553` -&gt; `ppm_7.5553...370`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_8.2458` -&gt; `ppm_8.2458...387`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_8.3515` -&gt; `ppm_8.3515...389`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_8.4608` -&gt; `ppm_8.4608...391`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_-0.0002` -&gt; `ppm_-0.0002...400`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8110` -&gt; `ppm_0.8110...411`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8552` -&gt; `ppm_0.8552...415`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8607` -&gt; `ppm_0.8607...416`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8784` -&gt; `ppm_0.8784...419`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8910` -&gt; `ppm_0.8910...420`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9085` -&gt; `ppm_0.9085...422`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9196` -&gt; `ppm_0.9196...423`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9313` -&gt; `ppm_0.9313...424`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9437` -&gt; `ppm_0.9437...425`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9554` -&gt; `ppm_0.9554...426`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9658` -&gt; `ppm_0.9658...427`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0093` -&gt; `ppm_1.0093...431`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0205` -&gt; `ppm_1.0205...432`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0716` -&gt; `ppm_1.0716...436`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0803` -&gt; `ppm_1.0803...437`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.1505` -&gt; `ppm_1.1505...441`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.2084` -&gt; `ppm_1.2084...443`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.2179` -&gt; `ppm_1.2179...444`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.2294` -&gt; `ppm_1.2294...445`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.3262` -&gt; `ppm_1.3262...449`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.3377` -&gt; `ppm_1.3377...450`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.4308` -&gt; `ppm_1.4308...451`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.4424` -&gt; `ppm_1.4424...452`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.4794` -&gt; `ppm_1.4794...453`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.5693` -&gt; `ppm_1.5693...460`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6195` -&gt; `ppm_1.6195...463`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6319` -&gt; `ppm_1.6319...464`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6441` -&gt; `ppm_1.6441...466`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6560` -&gt; `ppm_1.6560...467`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6562` -&gt; `ppm_1.6562...468`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6675` -&gt; `ppm_1.6675...470`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6747` -&gt; `ppm_1.6747...471`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6799` -&gt; `ppm_1.6799...473`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6990` -&gt; `ppm_1.6990...475`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.7075` -&gt; `ppm_1.7075...476`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.7614` -&gt; `ppm_1.7614...483`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.8752` -&gt; `ppm_1.8752...494`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.9812` -&gt; `ppm_1.9812...502`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0422` -&gt; `ppm_2.0422...509`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0923` -&gt; `ppm_2.0923...514`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1192` -&gt; `ppm_2.1192...517`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1273` -&gt; `ppm_2.1273...518`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1324` -&gt; `ppm_2.1324...519`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1572` -&gt; `ppm_2.1572...522`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1655` -&gt; `ppm_2.1655...523`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.2515` -&gt; `ppm_2.2515...530`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.2717` -&gt; `ppm_2.2717...533`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3451` -&gt; `ppm_2.3451...542`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3513` -&gt; `ppm_2.3513...543`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3575` -&gt; `ppm_2.3575...544`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3644` -&gt; `ppm_2.3644...545`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.4063` -&gt; `ppm_2.4063...549`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.4196` -&gt; `ppm_2.4196...550`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.4456` -&gt; `ppm_2.4456...553`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.4953` -&gt; `ppm_2.4953...558`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.5284` -&gt; `ppm_2.5284...562`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.7994` -&gt; `ppm_2.7994...576`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.9339` -&gt; `ppm_2.9339...585`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2154` -&gt; `ppm_3.2154...608`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2706` -&gt; `ppm_3.2706...613`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.3930` -&gt; `ppm_3.3930...616`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.4185` -&gt; `ppm_3.4185...618`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.5793` -&gt; `ppm_3.5793...633`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.6428` -&gt; `ppm_3.6428...638`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.6499` -&gt; `ppm_3.6499...639`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7237` -&gt; `ppm_3.7237...643`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7348` -&gt; `ppm_3.7348...644`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7642` -&gt; `ppm_3.7642...647`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7757` -&gt; `ppm_3.7757...648`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.8438` -&gt; `ppm_3.8438...653`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.8923` -&gt; `ppm_3.8923...659`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.9128` -&gt; `ppm_3.9128...661`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.9917` -&gt; `ppm_3.9917...668`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.0020` -&gt; `ppm_4.0020...669`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.2281` -&gt; `ppm_4.2281...682`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.2398` -&gt; `ppm_4.2398...684`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.2566` -&gt; `ppm_4.2566...687`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.5089` -&gt; `ppm_4.5089...705`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.5092` -&gt; `ppm_4.5092...706`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.5221` -&gt; `ppm_4.5221...707`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_5.0973` -&gt; `ppm_5.0973...712`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_5.4154` -&gt; `ppm_5.4154...720`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_6.1026` -&gt; `ppm_6.1026...731`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_6.9154` -&gt; `ppm_6.9154...745`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_6.9626` -&gt; `ppm_6.9626...746`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.2066` -&gt; `ppm_7.2066...750`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.3014` -&gt; `ppm_7.3014...755`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.3409` -&gt; `ppm_7.3409...758`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.4881` -&gt; `ppm_7.4881...768`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.5415` -&gt; `ppm_7.5415...771`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_8.2458` -&gt; `ppm_8.2458...788`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_8.4608` -&gt; `ppm_8.4608...790`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_-0.0002` -&gt; `ppm_-0.0002...795`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8110` -&gt; `ppm_0.8110...805`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8552` -&gt; `ppm_0.8552...809`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8655` -&gt; `ppm_0.8655...811`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.8729` -&gt; `ppm_0.8729...812`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9032` -&gt; `ppm_0.9032...815`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9085` -&gt; `ppm_0.9085...816`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9196` -&gt; `ppm_0.9196...817`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9313` -&gt; `ppm_0.9313...818`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_0.9902` -&gt; `ppm_0.9902...823`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0019` -&gt; `ppm_1.0019...824`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0205` -&gt; `ppm_1.0205...826`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0208` -&gt; `ppm_1.0208...827`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0410` -&gt; `ppm_1.0410...828`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0716` -&gt; `ppm_1.0716...831`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.0803` -&gt; `ppm_1.0803...832`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.1505` -&gt; `ppm_1.1505...836`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.1979` -&gt; `ppm_1.1979...837`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.2084` -&gt; `ppm_1.2084...838`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.2179` -&gt; `ppm_1.2179...839`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.2294` -&gt; `ppm_1.2294...840`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.3262` -&gt; `ppm_1.3262...844`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.3377` -&gt; `ppm_1.3377...845`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.4308` -&gt; `ppm_1.4308...846`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.4424` -&gt; `ppm_1.4424...847`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.4794` -&gt; `ppm_1.4794...848`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.4913` -&gt; `ppm_1.4913...849`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6319` -&gt; `ppm_1.6319...859`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6441` -&gt; `ppm_1.6441...860`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6443` -&gt; `ppm_1.6443...861`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6560` -&gt; `ppm_1.6560...862`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6562` -&gt; `ppm_1.6562...863`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6675` -&gt; `ppm_1.6675...864`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6747` -&gt; `ppm_1.6747...865`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6799` -&gt; `ppm_1.6799...867`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.6990` -&gt; `ppm_1.6990...870`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.7075` -&gt; `ppm_1.7075...873`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.7351` -&gt; `ppm_1.7351...877`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.7614` -&gt; `ppm_1.7614...880`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.8131` -&gt; `ppm_1.8131...885`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.8748` -&gt; `ppm_1.8748...892`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.8752` -&gt; `ppm_1.8752...893`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.9210` -&gt; `ppm_1.9210...896`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.9313` -&gt; `ppm_1.9313...897`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_1.9812` -&gt; `ppm_1.9812...902`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0026` -&gt; `ppm_2.0026...904`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0194` -&gt; `ppm_2.0194...907`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0307` -&gt; `ppm_2.0307...908`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0806` -&gt; `ppm_2.0806...914`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.0923` -&gt; `ppm_2.0923...915`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1149` -&gt; `ppm_2.1149...917`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1192` -&gt; `ppm_2.1192...918`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.1273` -&gt; `ppm_2.1273...919`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.2515` -&gt; `ppm_2.2515...932`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.2717` -&gt; `ppm_2.2717...935`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.2835` -&gt; `ppm_2.2835...937`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.2950` -&gt; `ppm_2.2950...939`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3251` -&gt; `ppm_2.3251...942`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3513` -&gt; `ppm_2.3513...945`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3575` -&gt; `ppm_2.3575...946`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.3711` -&gt; `ppm_2.3711...948`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.4063` -&gt; `ppm_2.4063...951`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.4196` -&gt; `ppm_2.4196...952`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.4456` -&gt; `ppm_2.4456...955`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.4912` -&gt; `ppm_2.4912...960`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.6216` -&gt; `ppm_2.6216...969`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.7577` -&gt; `ppm_2.7577...979`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.7994` -&gt; `ppm_2.7994...981`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.9332` -&gt; `ppm_2.9332...989`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_2.9339` -&gt; `ppm_2.9339...990`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.0305` -&gt; `ppm_3.0305...997`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.0404` -&gt; `ppm_3.0404...998`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.0489` -&gt; `ppm_3.0489...999`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2081` -&gt; `ppm_3.2081...1009`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2320` -&gt; `ppm_3.2320...1011`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2382` -&gt; `ppm_3.2382...1012`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.2672` -&gt; `ppm_3.2672...1014`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.3930` -&gt; `ppm_3.3930...1018`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.4031` -&gt; `ppm_3.4031...1019`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.4185` -&gt; `ppm_3.4185...1021`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.4243` -&gt; `ppm_3.4243...1022`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.4829` -&gt; `ppm_3.4829...1029`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.4981` -&gt; `ppm_3.4981...1031`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.5135` -&gt; `ppm_3.5135...1032`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.5372` -&gt; `ppm_3.5372...1034`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.5793` -&gt; `ppm_3.5793...1038`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.6428` -&gt; `ppm_3.6428...1043`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.6499` -&gt; `ppm_3.6499...1044`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7042` -&gt; `ppm_3.7042...1045`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7141` -&gt; `ppm_3.7141...1046`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7200` -&gt; `ppm_3.7200...1047`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7348` -&gt; `ppm_3.7348...1049`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7442` -&gt; `ppm_3.7442...1050`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.7642` -&gt; `ppm_3.7642...1052`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.8233` -&gt; `ppm_3.8233...1056`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.8528` -&gt; `ppm_3.8528...1060`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.8886` -&gt; `ppm_3.8886...1063`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.9091` -&gt; `ppm_3.9091...1065`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.9333` -&gt; `ppm_3.9333...1067`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_3.9493` -&gt; `ppm_3.9493...1068`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.0108` -&gt; `ppm_4.0108...1075`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.1205` -&gt; `ppm_4.1205...1080`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.1320` -&gt; `ppm_4.1320...1081`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.1927` -&gt; `ppm_4.1927...1084`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.2281` -&gt; `ppm_4.2281...1087`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.2566` -&gt; `ppm_4.2566...1093`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.4376` -&gt; `ppm_4.4376...1105`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.4531` -&gt; `ppm_4.4531...1107`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.5089` -&gt; `ppm_4.5089...1110`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.5092` -&gt; `ppm_4.5092...1111`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.5218` -&gt; `ppm_4.5218...1112`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_4.5906` -&gt; `ppm_4.5906...1117`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_5.0973` -&gt; `ppm_5.0973...1120`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_5.2369` -&gt; `ppm_5.2369...1123`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_6.9009` -&gt; `ppm_6.9009...1153`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_6.9154` -&gt; `ppm_6.9154...1154`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_6.9626` -&gt; `ppm_6.9626...1155`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.2066` -&gt; `ppm_7.2066...1160`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.2894` -&gt; `ppm_7.2894...1163`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.3409` -&gt; `ppm_7.3409...1167`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.3816` -&gt; `ppm_7.3816...1169`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.5415` -&gt; `ppm_7.5415...1176`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_7.5553` -&gt; `ppm_7.5553...1177`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_8.3515` -&gt; `ppm_8.3515...1194`</span>
<span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ppm_8.4608` -&gt; `ppm_8.4608...1195`</span>

<span class="va">peak_table_integration</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_integration_with_metadata.html">get_integration_with_metadata</a></span><span class="op">(</span><span class="va">peak_table_integration</span><span class="op">)</span></code></pre></div>
<p>We can also integrate with a specific peak position and some
arbitrary width:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/nmr_data.html">nmr_data</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/nmr_integrate_peak_positions.html">nmr_integrate_peak_positions</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="va">dataset_norm</span>,
                            peak_pos_ppm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.1925</span>, <span class="fl">4.183</span>, <span class="fl">4.1775</span>, <span class="fl">4.17</span><span class="op">)</span>,
                            peak_width_ppm <span class="op">=</span> <span class="fl">0.006</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt;      ppm_4.1925   ppm_4.1830   ppm_4.1775   ppm_4.1700</span>
<span class="co">#&gt; 10 3.237471e-07 3.331809e-07 3.281015e-07 3.199705e-07</span>
<span class="co">#&gt; 20 3.175618e-07 3.290769e-07 3.264927e-07 3.181403e-07</span>
<span class="co">#&gt; 30 3.145632e-07 3.239251e-07 3.211770e-07 3.090236e-07</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="integration-based-on-peak-boundaries">2. Integration based on peak boundaries<a class="anchor" aria-label="anchor" href="#integration-based-on-peak-boundaries"></a>
</h3>
<p>Imagine we only want to integrate the four peaks corresponding to the
pyroglutamic acid:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pyroglutamic_acid_region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.15</span>, <span class="fl">4.20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataset_norm</span>, chemshift_range <span class="op">=</span> <span class="va">pyroglutamic_acid_region</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Pyroglutamic acid region"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
<p>We define the peak regions and integrate them. Note how we can
correct the baseline or not. If we correct the baseline, the limits of
the integration will be connected with a straight line and that line
will be used as the baseline, that will be subtracted.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pyroglutamic_acid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pyroglutamic_acid1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.19</span>, <span class="fl">4.195</span><span class="op">)</span>,
                          pyroglutamic_acid2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.18</span>, <span class="fl">4.186</span><span class="op">)</span>,
                          pyroglutamic_acid3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.175</span>, <span class="fl">4.18</span><span class="op">)</span>,
                          pyroglutamic_acid4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.165</span>, <span class="fl">4.172</span><span class="op">)</span><span class="op">)</span>
<span class="va">regions_basel_corr_ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_integrate_regions.html">nmr_integrate_regions</a></span><span class="op">(</span><span class="va">dataset_norm</span>, <span class="va">pyroglutamic_acid</span>, fix_baseline <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">regions_basel_corr_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_data.html">nmr_data</a></span><span class="op">(</span><span class="va">regions_basel_corr_ds</span><span class="op">)</span>
<span class="va">regions_basel_corr_matrix</span>
<span class="co">#&gt;    pyroglutamic_acid1 pyroglutamic_acid2 pyroglutamic_acid3 pyroglutamic_acid4</span>
<span class="co">#&gt; 10       2.610786e-08       3.403464e-08       2.677797e-08       5.514992e-08</span>
<span class="co">#&gt; 20       2.155472e-08       1.777468e-08       1.203120e-08       5.139145e-08</span>
<span class="co">#&gt; 30       2.115166e-08       2.434735e-08       1.876817e-08       5.188576e-08</span>


<span class="va">regions_basel_not_corr_ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_integrate_regions.html">nmr_integrate_regions</a></span><span class="op">(</span><span class="va">dataset_norm</span>, <span class="va">pyroglutamic_acid</span>, fix_baseline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">regions_basel_not_corr_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_data.html">nmr_data</a></span><span class="op">(</span><span class="va">regions_basel_not_corr_ds</span><span class="op">)</span>
<span class="va">regions_basel_not_corr_matrix</span>
<span class="co">#&gt;    pyroglutamic_acid1 pyroglutamic_acid2 pyroglutamic_acid3 pyroglutamic_acid4</span>
<span class="co">#&gt; 10       2.789484e-07       3.331809e-07       2.702738e-07       3.786086e-07</span>
<span class="co">#&gt; 20       2.724326e-07       3.290769e-07       2.670492e-07       3.792872e-07</span>
<span class="co">#&gt; 30       2.699129e-07       3.239251e-07       2.636939e-07       3.681281e-07</span></code></pre></div>
<p>We may plot the integral values to explore variation based on the
baseline subtraction.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span>
  <span class="va">regions_basel_corr_matrix</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"NMRExperiment"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="st">"metabolite_peak"</span>, <span class="st">"area"</span>, <span class="op">-</span><span class="va">NMRExperiment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>BaselineCorrected <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  <span class="va">regions_basel_not_corr_matrix</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"NMRExperiment"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="st">"metabolite_peak"</span>, <span class="st">"area"</span>, <span class="op">-</span><span class="va">NMRExperiment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>BaselineCorrected <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NMRExperiment</span>, y <span class="op">=</span> <span class="va">area</span>, color <span class="op">=</span> <span class="va">metabolite_peak</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">BaselineCorrected</span><span class="op">)</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-27-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="identification">Identification<a class="anchor" aria-label="anchor" href="#identification"></a>
</h2>
<p>After applying any feature selection or machine learning, Alps allows
the identification of features of interest through
<code>nmr_identify_regions_blood</code>. The function gives 3
posibilities sorted by the most probable metabolite (see
<code>nmr_identify_regions_blood</code> for details).</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ppm_to_assign</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.060960203</span>, <span class="fl">3.048970634</span>,<span class="fl">2.405935596</span>,<span class="fl">0.990616851</span>,<span class="fl">0.986520147</span>, <span class="fl">1.044258467</span><span class="op">)</span>
<span class="va">identification</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_identify_regions_blood.html">nmr_identify_regions_blood</a></span> <span class="op">(</span><span class="va">ppm_to_assign</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="free-experimentation">Free experimentation<a class="anchor" aria-label="anchor" href="#free-experimentation"></a>
</h2>
<div class="section level3">
<h3 id="getting-the-spectra-and-manipulating-it-manually">Getting the spectra and manipulating it manually<a class="anchor" aria-label="anchor" href="#getting-the-spectra-and-manipulating-it-manually"></a>
</h3>
<p>Besides all those techniques, you can easily implement your own. You
can extract the raw matrix and manipulate it at will. As long as you
don’t permute the rows, you can always replace the raw matrix of the
<code>nmr_dataset_1D</code> object through the <code>nmr_data</code>
function:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">full_spectra_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmr_data.html">nmr_data</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span>
<span class="va">full_spectra_matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> <span class="co"># change it as you wish</span>
<span class="co">#&gt;        -0.5 -0.49977  -0.49954  -0.49931  -0.49908  -0.49885</span>
<span class="co">#&gt; 10 1672.044 1433.898 1072.3294 1401.1787 1634.7485 1344.6377</span>
<span class="co">#&gt; 20 1927.617 2056.491 1848.7379 1584.5820 1970.5705 2469.3993</span>
<span class="co">#&gt; 30 1337.001 1029.662  645.6248  641.0098  825.0757  799.6986</span>
<span class="fu"><a href="../reference/nmr_data.html">nmr_data</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">full_spectra_matrix</span> <span class="co"># Rewrite the matrix</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-an-nmr_dataset_1d-object-from-a-matrix">Creating an <code>nmr_dataset_1D</code> object from a matrix<a class="anchor" aria-label="anchor" href="#creating-an-nmr_dataset_1d-object-from-a-matrix"></a>
</h3>
<p>You can also create an <code>nmr_dataset_1D</code> object from
scratch with the <code>new_nmr_dataset_1D</code> function:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nsamp</span> <span class="op">&lt;-</span> <span class="fl">12</span>
<span class="va">npoints</span> <span class="op">&lt;-</span> <span class="fl">20</span>
<span class="co"># Create a random spectra matrix</span>
<span class="va">dummy_ppm_axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.2</span>, to <span class="op">=</span> <span class="fl">10</span>, length.out <span class="op">=</span> <span class="va">npoints</span><span class="op">)</span>
<span class="va">dummy_spectra_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nsamp</span><span class="op">*</span><span class="va">npoints</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nsamp</span>, ncol <span class="op">=</span> <span class="va">npoints</span><span class="op">)</span>
<span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>external <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NMRExperiment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>,
                                       DummyClass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>,
                                       stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="va">your_custom_nmr_dataset_1D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_nmr_dataset_1D.html">new_nmr_dataset_1D</a></span><span class="op">(</span>ppm_axis <span class="op">=</span> <span class="va">dummy_ppm_axis</span>,
                                                 data_1r <span class="op">=</span> <span class="va">dummy_spectra_matrix</span>,
                                                 metadata <span class="op">=</span> <span class="va">metadata</span><span class="op">)</span>
<span class="va">your_custom_nmr_dataset_1D</span>
<span class="co">#&gt; An nmr_dataset_1D (12 samples)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">your_custom_nmr_dataset_1D</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Of course those random values don't make much sense..."</span><span class="op">)</span></code></pre></div>
<p><img src="introduction-to-alpsnmr_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="final-thoughts">Final thoughts<a class="anchor" aria-label="anchor" href="#final-thoughts"></a>
</h2>
<p>This vignette shows many of the features of the package, some
features have room for improvement, others are not fully described, and
the reader will need to browse the documentation. Hopefully it is a good
starting point for using the package.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.1.3 (2022-03-10)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 20.04.4 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] BiocParallel_1.28.3 ggplot2_3.3.6       AlpsNMR_3.7.1      </span>
<span class="co">#&gt; [4] magrittr_2.0.3      future_1.26.1       dplyr_1.0.9        </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;   [1] matrixStats_0.62.0     fs_1.5.2               httr_1.4.3            </span>
<span class="co">#&gt;   [4] RColorBrewer_1.1-3     rprojroot_2.0.3        doRNG_1.8.2           </span>
<span class="co">#&gt;   [7] tools_4.1.3            bslib_0.3.1            utf8_1.2.2            </span>
<span class="co">#&gt;  [10] R6_2.5.1               colorspace_2.0-3       withr_2.5.0           </span>
<span class="co">#&gt;  [13] tidyselect_1.1.2       gridExtra_2.3          compiler_4.1.3        </span>
<span class="co">#&gt;  [16] MassSpecWavelet_1.60.1 progressr_0.10.1       rvest_1.0.2           </span>
<span class="co">#&gt;  [19] textshaping_0.3.6      cli_3.3.0              SparseM_1.81          </span>
<span class="co">#&gt;  [22] xml2_1.3.3             desc_1.4.1             labeling_0.4.2        </span>
<span class="co">#&gt;  [25] sass_0.4.1             scales_1.2.0           mvtnorm_1.1-3         </span>
<span class="co">#&gt;  [28] randomForest_4.7-1.1   quadprog_1.5-8         pkgdown_2.0.4         </span>
<span class="co">#&gt;  [31] systemfonts_1.0.4      stringr_1.4.0          digest_0.6.29         </span>
<span class="co">#&gt;  [34] rmarkdown_2.14         pkgconfig_2.0.3        htmltools_0.5.2       </span>
<span class="co">#&gt;  [37] parallelly_1.32.0      itertools_0.1-3        fastmap_1.1.0         </span>
<span class="co">#&gt;  [40] highr_0.9              rlang_1.0.2            readxl_1.4.0          </span>
<span class="co">#&gt;  [43] impute_1.68.0          jquerylib_0.1.4        farver_2.1.0          </span>
<span class="co">#&gt;  [46] generics_0.1.2         jsonlite_1.8.0         speaq_2.7.0           </span>
<span class="co">#&gt;  [49] Matrix_1.4-1           Rcpp_1.0.8.3           munsell_0.5.0         </span>
<span class="co">#&gt;  [52] fansi_1.0.3            lifecycle_1.0.1        RcppZiggurat_0.1.6    </span>
<span class="co">#&gt;  [55] stringi_1.7.6          yaml_2.3.5             MASS_7.3-57           </span>
<span class="co">#&gt;  [58] plyr_1.8.7             grid_4.1.3             parallel_4.1.3        </span>
<span class="co">#&gt;  [61] listenv_0.8.0          ggrepel_0.9.1          doSNOW_1.0.20         </span>
<span class="co">#&gt;  [64] crayon_1.5.1           lattice_0.20-45        knitr_1.39            </span>
<span class="co">#&gt;  [67] pillar_1.7.0           igraph_1.3.2           rngtools_1.5.2        </span>
<span class="co">#&gt;  [70] corpcor_1.6.10         reshape2_1.4.4         codetools_0.2-18      </span>
<span class="co">#&gt;  [73] mixOmics_6.18.1        lpSolve_5.6.15         glue_1.6.2            </span>
<span class="co">#&gt;  [76] evaluate_0.15          data.table_1.14.2      missForest_1.5        </span>
<span class="co">#&gt;  [79] foreach_1.5.2          vctrs_0.4.1            cellranger_1.1.0      </span>
<span class="co">#&gt;  [82] gtable_0.3.0           purrr_0.3.4            tidyr_1.2.0           </span>
<span class="co">#&gt;  [85] cachem_1.0.6           xfun_0.31              limSolve_1.5.6        </span>
<span class="co">#&gt;  [88] Rfast_2.0.6            RSpectra_0.16-1        baseline_1.3-1        </span>
<span class="co">#&gt;  [91] ragg_1.2.2             pcaPP_2.0-1            rARPACK_0.11-0        </span>
<span class="co">#&gt;  [94] signal_0.7-7           tibble_3.1.7           snow_0.4-4            </span>
<span class="co">#&gt;  [97] iterators_1.0.14       memoise_2.0.1          ellipse_0.4.3         </span>
<span class="co">#&gt; [100] cluster_2.1.3          globals_0.15.0         ellipsis_0.3.2</span></code></pre></div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>e.g. it can inadvertedly distort the PQN normalization
results<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ivan Montoliu Roura, Sergio Oller Moreno, Francisco Madrid Gambin, Luis Fernandez, Héctor Gracia Cabrera, Santiago Marco Colás.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
